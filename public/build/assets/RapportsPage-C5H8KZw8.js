import{_ as Je,a as F,h as Ge,b as G,c as Ze,u as Xe,S as et,d as tt,e as xe}from"./react-select.esm-B9Exsq2_.js";import{a as c,j as e,b as T,R as V}from"./axios-DGPLTa3G.js";var st=["defaultOptions","cacheOptions","loadOptions","options","isLoading","onInputChange","filterOption"];function at(t){var s=t.defaultOptions,a=s===void 0?!1:s,n=t.cacheOptions,l=n===void 0?!1:n,r=t.loadOptions;t.options;var i=t.isLoading,d=i===void 0?!1:i,o=t.onInputChange,u=t.filterOption,p=u===void 0?null:u,m=Je(t,st),h=m.inputValue,j=c.useRef(void 0),f=c.useRef(!1),v=c.useState(Array.isArray(a)?a:void 0),D=F(v,2),O=D[0],A=D[1],R=c.useState(typeof h<"u"?h:""),H=F(R,2),g=H[0],b=H[1],_=c.useState(a===!0),S=F(_,2),L=S[0],y=S[1],M=c.useState(void 0),x=F(M,2),C=x[0],E=x[1],N=c.useState([]),P=F(N,2),Q=P[0],z=P[1],$e=c.useState(!1),ue=F($e,2),qe=ue[0],J=ue[1],Pe=c.useState({}),me=F(Pe,2),B=me[0],he=me[1],Ve=c.useState(void 0),pe=F(Ve,2),He=pe[0],ze=pe[1],Ke=c.useState(void 0),fe=F(Ke,2),We=fe[0],Be=fe[1];l!==We&&(he({}),Be(l)),a!==He&&(A(Array.isArray(a)?a:void 0),ze(a)),c.useEffect(function(){return f.current=!0,function(){f.current=!1}},[]);var te=c.useCallback(function(Y,K){if(!r)return K();var w=r(Y,K);w&&typeof w.then=="function"&&w.then(K,function(){return K()})},[r]);c.useEffect(function(){a===!0&&te(g,function(Y){f.current&&(A(Y||[]),y(!!j.current))})},[]);var Ye=c.useCallback(function(Y,K){var w=Ge(Y,K,o);if(!w){j.current=void 0,b(""),E(""),z([]),y(!1),J(!1);return}if(l&&B[w])b(w),E(w),z(B[w]),y(!1),J(!1);else{var Qe=j.current={};b(w),y(!0),J(!C),te(w,function(se){f&&Qe===j.current&&(j.current=void 0,y(!1),E(w),z(se||[]),J(!1),he(se?G(G({},B),{},Ze({},w,se)):B))})}},[l,te,C,B,o]),Ue=qe?[]:g&&C?Q:O||[];return G(G({},m),{},{options:Ue,isLoading:L||d,onInputChange:Ye,filterOption:p})}var nt=c.forwardRef(function(t,s){var a=at(t),n=Xe(a);return c.createElement(et,tt({ref:s},n))}),ts=nt;const ss=({paiement:t,setPaiement:s,payer:a})=>e.jsx("div",{className:"modal fade","data-bs-backdrop":"static",tabindex:"-1",id:"paiement-modal",style:{display:"none"},children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title align-self-center",children:"Paiement"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"col-12 mt-3",style:{display:"none"},children:[e.jsx("label",{htmlFor:"date_paiement",className:"form-label required",children:"Date de paiement"}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{required:!0,className:"form-control datupickeru","data-provide":"datepicker","data-date-autoclose":"true",type:"text",id:"date_paiement",value:t.i_date_paiement,onChange:n=>s({...t,i_date_paiement:document.querySelector("#date_paiement").value,i_date:document.querySelector("#date_prevu").value})}),e.jsx("span",{className:"input-group-text",children:e.jsx("i",{className:"fa fa-calendar-alt"})})]})]}),e.jsxs("div",{className:"col-12 mt-3",children:[e.jsx("label",{htmlFor:"montant",className:"form-label required",children:"Montant de paiement"}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{required:!0,className:"form-control",step:"0.01",min:"1",max:t.i_montant,type:"number",value:t.i_montant,onChange:n=>s({...t,i_montant:n.target.value,i_date_paiement:document.querySelector("#date_paiement").value,i_date:document.querySelector("#date_prevu").value}),id:"montant"}),e.jsx("span",{className:"input-group-text",children:"MAD"})]})]}),e.jsxs("div",{className:"col-12 mt-3",children:[e.jsx("label",{htmlFor:"compte-input",className:"form-label required",children:"Compte"}),e.jsx(xe,{classNames:{control:()=>"border-light shadow-none",option:n=>n.isFocused?"bg-primary text-white":n.isSelected?"bg-soft-primary text-white":n.isDisabled?"bg-soft-light text-muted":"",singleValue:n=>{n.isFocused}},cache:!1,value:t.i_compte_id,onChange:n=>s({...t,i_compte_id:n,i_date_paiement:document.querySelector("#date_paiement").value,i_date:document.querySelector("#date_prevu").value}),options:__comptes})]}),e.jsxs("div",{className:"col-12 mt-3",children:[e.jsx("label",{htmlFor:"method-input",className:"form-label required",children:"Méthode de paiement"}),e.jsx(xe,{classNames:{control:()=>"border-light shadow-none",option:n=>n.isFocused?"bg-primary text-white":n.isSelected?"bg-soft-primary text-white":n.isDisabled?"bg-soft-light text-muted":"",singleValue:n=>{n.isFocused}},cache:!1,value:t.i_method_key,onChange:n=>{s({...t,i_method_key:n,i_date_paiement:document.querySelector("#date_paiement").value,i_date:document.querySelector("#date_prevu").value})},options:__methodes})]}),e.jsxs("div",{className:"col-12 mt-3",style:{display:t.i_method_key.value==="cheque"||t.i_method_key.value==="lcn"?"":"none"},children:[e.jsx("label",{htmlFor:"date",className:"form-label required",children:"Date prévu"}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{required:!0,className:"form-control datupickeru","data-provide":"datepicker","data-date-autoclose":"true",type:"text",id:"date_prevu",value:t.i_date,onChange:n=>s({...t,i_date_paiement:document.querySelector("#date_paiement").value,i_date:document.querySelector("#date_prevu").value})}),e.jsx("span",{className:"input-group-text",children:e.jsx("i",{className:"fa fa-calendar-alt"})})]})]}),e.jsxs("div",{className:"col-12 mt-3 ",style:{display:t.i_method_key.value==="cheque"||t.i_method_key.value==="lcn"?" ":"none"},children:[e.jsx("label",{htmlFor:"i_reference",className:"form-label required",children:"Référence de chéque"}),e.jsx("input",{required:!0,className:"form-control",type:"text",value:t.i_reference,onChange:n=>s({...t,i_reference:n.target.value,i_date_paiement:document.querySelector("#date_paiement").value,i_date:document.querySelector("#date_prevu").value})})]}),e.jsxs("div",{className:"col-12 mt-3",children:[e.jsx("label",{htmlFor:"i_note",className:"form-label",children:"Note"}),e.jsx("textarea",{className:"form-control",rows:"3",value:t.i_note,onChange:n=>s({...t,i_note:n.target.value,i_date_paiement:document.querySelector("#date_paiement").value,i_date:document.querySelector("#date_prevu").value})})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-light","data-bs-dismiss":"modal",children:"Fermer"}),e.jsx("button",{className:"btn btn-info",onClick:()=>a(),children:"Payer"})]})]})})}),as=({setClient:t,setIsLoading:s})=>{const[a,n]=c.useState({city:null,nom:null,telephone:null,adresse:null}),l=()=>{s(!0),T.post("clients",{...a}).then(r=>{t(r.data.client),s(!1),toastr.success(r.data.message),$("#client-modal").modal("hide"),n({city:null,nom:null,telephone:null,adresse:null})}).catch(r=>{if(s(!1),r.response.status==422){let i=r.response.data.errors,d="";for(let o in i)d+=`<p class="text-white">${i[o][0]}</p>`;toastr.warning(d)}else toastr.error("Vuillez ressayer plus tard")})};return e.jsx("div",{class:"modal fade ",id:"client-modal",tabindex:"-1","aria-hidden":"true",style:{display:"none"},children:e.jsx("div",{class:"modal-dialog  modal-dialog-centered",children:e.jsxs("div",{class:"modal-content ",children:[e.jsxs("div",{class:"modal-header",children:[e.jsx("h5",{class:"modal-title align-self-center",id:"edit-cat-modal-title",children:"Ajout rapide de client"}),e.jsx("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),e.jsxs("div",{class:"row px-3 align-items-start pt-4",children:[e.jsxs("div",{class:"col-12  mb-3",children:[e.jsx("label",{for:"nom",class:"form-label required",id:"dynamic_label",children:"Dénomination"}),e.jsx("input",{type:"text",class:"form-control ",id:"nom",name:"nom",required:!0,value:a.nom,onChange:r=>n({...a,nom:r.target.value}),placeholder:"Nom du client"})]}),e.jsxs("div",{class:"col-12 mb-3",children:[e.jsx("label",{for:"telephone",class:"form-label",children:"Téléphone"}),e.jsx("input",{type:"tel",class:"form-control",id:"telephone",name:"telephone",value:a.telephone,onChange:r=>n({...a,telephone:r.target.value}),placeholder:"Numéro de téléphone"})]}),e.jsxs("div",{class:"col-12  mb-3",children:[e.jsx("label",{for:"city",class:"form-label",children:"Ville"}),e.jsx("input",{type:"text",className:"form-control",value:a.city,id:"city",onChange:r=>n({...a,city:r.target.value}),placeholder:"Ville du client"})]})]}),e.jsxs("div",{class:"modal-footer",children:[e.jsx("button",{type:"button",class:"btn btn-light","data-bs-dismiss":"modal",children:"Fermer"}),e.jsx("button",{onClick:()=>l(),type:"button",id:"add-btn-client",class:"btn btn-primary",children:"Enregistrer"})]})]})})})},be=({item:t,setHistory:s})=>{const a=l=>{T.get("ventes/ticket/"+l).then(r=>{n(r.data)}).catch(r=>{})};function n(l){document.getElementById("iframe")&&document.getElementById("iframe").remove();let r=document.createElement("iframe");r.style.display="none",r.id="iframe",r.srcdoc=l,document.body.append(r),r.contentWindow.focus(),r.contentWindow.print()}return e.jsx("a",{className:"col-12","data-bs-dismiss":"offcanvas",children:e.jsxs("div",{className:"card py-0 border flex-row",children:[e.jsx("div",{className:"card-body py-2",onClick:()=>{s(t),setTimeout(()=>{$("#history-modal").modal("show")},500)},children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h5",{className:"text-black-50 col-4 m-0",children:t.reference}),e.jsx("h5",{className:"text-black-50 col-4 m-0",children:t.time}),e.jsx("h5",{className:"m-0 col-4 text-end",children:t.total})]})}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>a(t.id),children:[" ",e.jsx("i",{className:"fa fa-print"})," "]})]})},t.id)},rt=({item:t,reduction:s})=>e.jsx("div",{class:"modal fade","data-bs-backdrop":"static",tabindex:"-1",id:"history-modal",style:{display:"none"},children:e.jsx("div",{class:"modal-dialog modal-dialog-centered modal-lg",children:t?e.jsxs("div",{class:"modal-content",children:[e.jsxs("div",{class:"modal-header",children:[e.jsxs("h5",{class:"modal-title align-self-center",children:[t.type," ",t.reference]}),e.jsx("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),e.jsxs("div",{class:"modal-body",children:[e.jsxs("div",{class:"row py-1 px-1 mx-0",children:[e.jsxs("div",{class:" col-sm-6 col-md-4 mt-3 d-flex align-items-center",children:[e.jsx("div",{class:"rounded bg-soft-info  p-2 d-flex align-items-center justify-content-center",style:{width:"49px"},children:e.jsx("i",{class:"fa fa-id-card fa-2x"})}),e.jsxs("div",{class:"ms-3 ",children:[e.jsx("span",{class:"font-weight-bolder font-size-sm",children:"Reference"}),e.jsx("p",{class:"mb-0 h5 text-black",children:t.reference})]})]}),e.jsxs("div",{class:" col-sm-6 col-md-4 mt-3 d-flex align-items-center",children:[e.jsx("div",{class:"rounded bg-soft-success  p-2 d-flex align-items-center justify-content-center",style:{width:"49px"},children:e.jsx("i",{class:"fa fa-building fa-2x"})}),e.jsxs("div",{class:"ms-3 ",children:[e.jsx("span",{class:"font-weight-bolder font-size-sm",children:"Client"}),e.jsx("p",{class:"mb-0 h5 text-black text-capitalize",children:t.client_nom})]})]}),e.jsxs("div",{class:" col-sm-6 col-md-4   mt-3  d-flex align-items-center",children:[e.jsx("div",{class:"rounded bg-soft-danger p-2 d-flex align-items-center justify-content-center",style:{width:"49px"},children:e.jsx("i",{class:"fa fa-calendar-alt fa-2x"})}),e.jsxs("div",{class:"ms-3 ",children:[e.jsx("span",{class:"font-weight-bolder font-size-sm",children:"Date d'emission"}),e.jsx("p",{class:"mb-0 h5 text-black text-capitalize",children:t.time})]})]}),e.jsxs("div",{class:" col-sm-6 col-md-4 mt-3 d-flex align-items-center",children:[e.jsx("div",{class:"rounded bg-soft-warning  p-2 d-flex align-items-center justify-content-center",style:{width:"49px"},children:e.jsx("i",{class:"fa fa-star fa-2x"})}),e.jsxs("div",{class:"ms-3 ",children:[e.jsx("span",{class:"font-weight-bolder font-size-sm",children:"Statut"}),e.jsx("p",{class:"mb-0 h5 text-black text-capitalize",children:t.statut})]})]}),e.jsxs("div",{class:" col-sm-6 col-md-4  mt-3 d-flex align-items-md-start",children:[e.jsx("div",{class:"rounded bg-soft-purple p-2 d-flex align-items-center justify-content-center",style:{width:"49px"},children:e.jsx("i",{class:"fa fa-coins fa-2x"})}),e.jsxs("div",{class:"ms-3 ",children:[e.jsxs("span",{class:"font-weight-bolder font-size-sm",children:["Montant TTC"," "]}),e.jsx("p",{class:"mb-0 h5 text-black text-capitalize",children:t.total})]})]})]}),e.jsxs("table",{className:"table table-bordered table-striped mt-3",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-primary text-white",children:[e.jsx("th",{className:"text-white",children:"Produit"}),e.jsx("th",{className:"text-white",children:"Quantité"}),e.jsx("th",{className:"text-white",children:"Prix"}),s?e.jsx("th",{className:"text-white",children:"Reduction"}):"",e.jsx("th",{className:"text-white",children:"Total"})]})}),e.jsx("tbody",{children:t.lignes.map((a,n)=>e.jsxs("tr",{children:[e.jsx("td",{children:a.article}),e.jsxs("td",{children:[a.quantity," ",a.unite]}),e.jsx("td",{children:a.price}),s?e.jsx("td",{children:a.reduction}):"",e.jsx("td",{children:a.total_ttc})]},n))})]})]}),e.jsx("div",{class:"modal-footer",children:e.jsx("button",{type:"button",class:"btn btn-light","data-bs-dismiss":"modal",children:"Fermer"})})]}):""})}),lt=({item:t})=>e.jsx("div",{className:"col-6",children:e.jsx("div",{className:"card border",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h5",{className:"text-black-50",children:t.reference}),e.jsx("h5",{className:"text-black-50",children:t.date})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h5",{className:"m-0",children:e.jsx("span",{className:"text-black-50",children:"Dépense:"})}),e.jsx("h5",{className:"m-0",children:t.nom})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h5",{className:"m-0",children:e.jsx("span",{className:"text-black-50",children:"Bénéficiaire:"})}),e.jsx("h5",{className:"m-0",children:t.beneficiaire})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h5",{className:"m-0",children:e.jsx("span",{className:"text-black-50",children:"Catégorie:"})}),e.jsx("h5",{className:"m-0",children:t.category})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h5",{className:"m-0",children:e.jsx("span",{className:"text-black-50",children:"Montant TTC:"})}),e.jsxs("h5",{className:"m-0",children:[t.total," MAD"]})]})]})})},t.id),ns=({reduction:t})=>{const[s,a]=c.useState([]),[n,l]=c.useState([]),[r,i]=c.useState(null),[d,o]=c.useState(!1),[u,p]=c.useState([]),[m,h]=c.useState("ventes"),[j,f]=c.useState([]),v=()=>s.length>0?s.map(b=>e.jsx(be,{setHistory:i,item:b})):e.jsx("h5",{className:"text-center",children:"Aucun vente"}),D=()=>n.length>0?n.map(b=>e.jsx(be,{setHistory:i,item:b})):e.jsx("h5",{className:"text-center",children:"Aucun retour"}),O=()=>u.length>0?u.map(b=>e.jsx(lt,{item:b})):e.jsx("h5",{className:"text-center",children:"Aucune dépense"}),[A,R]=c.useState(!1),H=()=>{let b=s.reduce((L,y)=>+L+parseInt(y.total_ttc,10),0),_=u.reduce((L,y)=>+L+parseInt(y.total,10),0),S=n.reduce((L,y)=>+L+parseInt(y.total,10),0);return e.jsxs(e.Fragment,{children:[e.jsxs("h5",{className:"m-0",children:["Total Ventes: ",b.toFixed(2)+" MAD"]}),e.jsxs("h5",{className:"m-0",children:["Total Retours: ",S.toFixed(2)+" MAD"]}),e.jsxs("h5",{className:"m-0",children:["Total Dépenses: ",_.toFixed(2)+" MAD"]}),e.jsxs("h5",{className:"m-0",children:["Total : ",(b-S-_).toFixed(2)+" MAD"]})]})},g=()=>{if(A)return;R(!0);let b={session_id:__session_id};T.get("history",{params:b}).then(_=>{a(_.data.ventes),l(_.data.retours),p(_.data.depenses),R(!1),__is_rebut==1&&T.get("rebuts",{params:{session_id:__session_id}}).then(S=>f(S.data||[])).catch(()=>f([]))})};return $(document).on("show.bs.offcanvas","#offcanvasExample",function(){o(!0)}),$(document).on("hide.bs.offcanvas","#offcanvasExample",function(){o(!1)}),c.useEffect(()=>{d&&g()},[d]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"offcanvas offcanvas-end",tabindex:"-1",id:"offcanvasExample","aria-labelledby":"offcanvasExampleLabel",style:{width:"800px"},children:[e.jsxs("div",{class:"offcanvas-header",children:[e.jsx("h5",{class:"offcanvas-title",id:"offcanvasExampleLabel",children:"Historique"}),e.jsx("button",{type:"button",class:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close"})]}),e.jsxs("div",{class:"offcanvas-body d-flex flex-column",children:[e.jsxs("div",{className:"d-flex",children:[e.jsx("button",{className:m==="ventes"?"btn btn-light me-2 mb-2 history-tab active":"btn btn-light me-2 mb-2  history-tab",onClick:()=>h("ventes"),children:"Vente"}),e.jsx("button",{className:m==="retours"?"btn btn-light me-2 mb-2 history-tab active":"btn btn-light me-2 mb-2  history-tab",onClick:()=>h("retours"),children:"Retours"}),e.jsx("button",{className:m==="depenses"?"btn btn-light me-2 mb-2 history-tab active":"btn btn-light me-2 mb-2  history-tab",onClick:()=>h("depenses"),children:"Dépenses"}),__is_rebut==1&&e.jsx("button",{className:m==="rebuts"?"btn btn-light me-2 mb-2 history-tab active":"btn btn-light me-2 mb-2 history-tab",onClick:()=>h("rebuts"),children:"Rebut"})]}),e.jsxs("div",{className:"card shadow-none flex-grow-1 d-flex flex-column",children:[e.jsx("div",{className:"card-body flex-grow-1",children:A?e.jsx("div",{className:"d-flex align-items-center justify-content-center",children:e.jsx("div",{className:"spinner-border",role:"status"})}):m==="ventes"?e.jsx("div",{className:"row",children:v()}):m==="depenses"?e.jsx("div",{className:"row",children:O()}):m==="retours"?e.jsx("div",{className:"row",children:D()}):m==="rebuts"?j.length===0?e.jsx("div",{className:"row",children:e.jsx("h5",{className:"text-center",children:"Aucun rebut"})}):e.jsx("div",{className:"row",children:j.map(b=>e.jsx("div",{className:"col-12 mb-2",children:e.jsx("div",{className:"card shadow-sm",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[e.jsx("div",{className:"fw-semibold",children:b.reference}),e.jsx("small",{className:"text-muted",children:"Quantité rebutée"})]}),e.jsx("ul",{className:"list-unstyled mb-0",children:(b.lignes||[]).map((_,S)=>e.jsxs("li",{className:"d-flex justify-content-between border-top py-1",children:[e.jsx("span",{children:_.article}),e.jsx("span",{className:"fw-semibold",children:_.quantity})]},S))})]})})},b.id))}):null}),e.jsxs("div",{className:"card-body border-top border-light flex-grow-0 d-flex align-baseline justify-content-between",children:[e.jsx("div",{children:H()}),e.jsxs("p",{children:["Ouverture de session: ",__ouverture]})]})]})]})]}),e.jsx(rt,{reduction:t,item:r})]})},I=new Map,ae={set(t,s,a){I.has(t)||I.set(t,new Map);const n=I.get(t);if(!n.has(s)&&n.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(n.keys())[0]}.`);return}n.set(s,a)},get(t,s){return I.has(t)&&I.get(t).get(s)||null},remove(t,s){if(!I.has(t))return;const a=I.get(t);a.delete(s),a.size===0&&I.delete(t)}},it=1e3,ce="transitionend",we=t=>(t&&window.CSS&&window.CSS.escape&&(t=t.replace(/#([^\s"#']+)/g,(s,a)=>`#${CSS.escape(a)}`)),t),ct=t=>t==null?`${t}`:Object.prototype.toString.call(t).match(/\s([a-z]+)/i)[1].toLowerCase(),ot=t=>{if(!t)return 0;let{transitionDuration:s,transitionDelay:a}=window.getComputedStyle(t);const n=Number.parseFloat(s),l=Number.parseFloat(a);return!n&&!l?0:(s=s.split(",")[0],a=a.split(",")[0],(Number.parseFloat(s)+Number.parseFloat(a))*it)},dt=t=>{t.dispatchEvent(new Event(ce))},U=t=>!t||typeof t!="object"?!1:(typeof t.jquery<"u"&&(t=t[0]),typeof t.nodeType<"u"),je=t=>U(t)?t.jquery?t[0]:t:typeof t=="string"&&t.length>0?document.querySelector(we(t)):null,ut=t=>{if(!U(t)||t.getClientRects().length===0)return!1;const s=getComputedStyle(t).getPropertyValue("visibility")==="visible",a=t.closest("details:not([open])");if(!a)return s;if(a!==t){const n=t.closest("summary");if(n&&n.parentNode!==a||n===null)return!1}return s},Se=t=>!t||t.nodeType!==Node.ELEMENT_NODE||t.classList.contains("disabled")?!0:typeof t.disabled<"u"?t.disabled:t.hasAttribute("disabled")&&t.getAttribute("disabled")!=="false",mt=t=>{t.offsetHeight},Ee=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,ne=[],ht=t=>{document.readyState==="loading"?(ne.length||document.addEventListener("DOMContentLoaded",()=>{for(const s of ne)s()}),ne.push(t)):t()},pt=t=>{ht(()=>{const s=Ee();if(s){const a=t.NAME,n=s.fn[a];s.fn[a]=t.jQueryInterface,s.fn[a].Constructor=t,s.fn[a].noConflict=()=>(s.fn[a]=n,t.jQueryInterface)}})},ge=(t,s=[],a=t)=>typeof t=="function"?t(...s):a,ft=(t,s,a=!0)=>{if(!a){ge(t);return}const l=ot(s)+5;let r=!1;const i=({target:d})=>{d===s&&(r=!0,s.removeEventListener(ce,i),ge(t))};s.addEventListener(ce,i),setTimeout(()=>{r||dt(s)},l)},xt=/[^.]*(?=\..*)\.|.*/,bt=/\..*/,jt=/::\d+$/,re={};let Ne=1;const ke={mouseenter:"mouseover",mouseleave:"mouseout"},gt=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Ae(t,s){return s&&`${s}::${Ne++}`||t.uidEvent||Ne++}function De(t){const s=Ae(t);return t.uidEvent=s,re[s]=re[s]||{},re[s]}function Nt(t,s){return function a(n){return de(n,{delegateTarget:t}),a.oneOff&&k.off(t,n.type,s),s.apply(t,[n])}}function vt(t,s,a){return function n(l){const r=t.querySelectorAll(s);for(let{target:i}=l;i&&i!==this;i=i.parentNode)for(const d of r)if(d===i)return de(l,{delegateTarget:i}),n.oneOff&&k.off(t,l.type,s,a),a.apply(i,[l])}}function Re(t,s,a=null){return Object.values(t).find(n=>n.callable===s&&n.delegationSelector===a)}function Le(t,s,a){const n=typeof s=="string",l=n?a:s||a;let r=Oe(t);return gt.has(r)||(r=t),[n,l,r]}function ve(t,s,a,n,l){if(typeof s!="string"||!t)return;let[r,i,d]=Le(s,a,n);s in ke&&(i=(f=>function(v){if(!v.relatedTarget||v.relatedTarget!==v.delegateTarget&&!v.delegateTarget.contains(v.relatedTarget))return f.call(this,v)})(i));const o=De(t),u=o[d]||(o[d]={}),p=Re(u,i,r?a:null);if(p){p.oneOff=p.oneOff&&l;return}const m=Ae(i,s.replace(xt,"")),h=r?vt(t,a,i):Nt(t,i);h.delegationSelector=r?a:null,h.callable=i,h.oneOff=l,h.uidEvent=m,u[m]=h,t.addEventListener(d,h,r)}function oe(t,s,a,n,l){const r=Re(s[a],n,l);r&&(t.removeEventListener(a,r,!!l),delete s[a][r.uidEvent])}function _t(t,s,a,n){const l=s[a]||{};for(const[r,i]of Object.entries(l))r.includes(n)&&oe(t,s,a,i.callable,i.delegationSelector)}function Oe(t){return t=t.replace(bt,""),ke[t]||t}const k={on(t,s,a,n){ve(t,s,a,n,!1)},one(t,s,a,n){ve(t,s,a,n,!0)},off(t,s,a,n){if(typeof s!="string"||!t)return;const[l,r,i]=Le(s,a,n),d=i!==s,o=De(t),u=o[i]||{},p=s.startsWith(".");if(typeof r<"u"){if(!Object.keys(u).length)return;oe(t,o,i,r,l?a:null);return}if(p)for(const m of Object.keys(o))_t(t,o,m,s.slice(1));for(const[m,h]of Object.entries(u)){const j=m.replace(jt,"");(!d||s.includes(j))&&oe(t,o,i,h.callable,h.delegationSelector)}},trigger(t,s,a){if(typeof s!="string"||!t)return null;const n=Ee(),l=Oe(s),r=s!==l;let i=null,d=!0,o=!0,u=!1;r&&n&&(i=n.Event(s,a),n(t).trigger(i),d=!i.isPropagationStopped(),o=!i.isImmediatePropagationStopped(),u=i.isDefaultPrevented());const p=de(new Event(s,{bubbles:d,cancelable:!0}),a);return u&&p.preventDefault(),o&&t.dispatchEvent(p),p.defaultPrevented&&i&&i.preventDefault(),p}};function de(t,s={}){for(const[a,n]of Object.entries(s))try{t[a]=n}catch{Object.defineProperty(t,a,{configurable:!0,get(){return n}})}return t}function _e(t){if(t==="true")return!0;if(t==="false")return!1;if(t===Number(t).toString())return Number(t);if(t===""||t==="null")return null;if(typeof t!="string")return t;try{return JSON.parse(decodeURIComponent(t))}catch{return t}}function le(t){return t.replace(/[A-Z]/g,s=>`-${s.toLowerCase()}`)}const ye={setDataAttribute(t,s,a){t.setAttribute(`data-bs-${le(s)}`,a)},removeDataAttribute(t,s){t.removeAttribute(`data-bs-${le(s)}`)},getDataAttributes(t){if(!t)return{};const s={},a=Object.keys(t.dataset).filter(n=>n.startsWith("bs")&&!n.startsWith("bsConfig"));for(const n of a){let l=n.replace(/^bs/,"");l=l.charAt(0).toLowerCase()+l.slice(1,l.length),s[l]=_e(t.dataset[n])}return s},getDataAttribute(t,s){return _e(t.getAttribute(`data-bs-${le(s)}`))}};class yt{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(s){return s=this._mergeConfigObj(s),s=this._configAfterMerge(s),this._typeCheckConfig(s),s}_configAfterMerge(s){return s}_mergeConfigObj(s,a){const n=U(a)?ye.getDataAttribute(a,"config"):{};return{...this.constructor.Default,...typeof n=="object"?n:{},...U(a)?ye.getDataAttributes(a):{},...typeof s=="object"?s:{}}}_typeCheckConfig(s,a=this.constructor.DefaultType){for(const[n,l]of Object.entries(a)){const r=s[n],i=U(r)?"element":ct(r);if(!new RegExp(l).test(i))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${n}" provided type "${i}" but expected type "${l}".`)}}}const Ct="5.3.3";class wt extends yt{constructor(s,a){super(),s=je(s),s&&(this._element=s,this._config=this._getConfig(a),ae.set(this._element,this.constructor.DATA_KEY,this))}dispose(){ae.remove(this._element,this.constructor.DATA_KEY),k.off(this._element,this.constructor.EVENT_KEY);for(const s of Object.getOwnPropertyNames(this))this[s]=null}_queueCallback(s,a,n=!0){ft(s,a,n)}_getConfig(s){return s=this._mergeConfigObj(s,this._element),s=this._configAfterMerge(s),this._typeCheckConfig(s),s}static getInstance(s){return ae.get(je(s),this.DATA_KEY)}static getOrCreateInstance(s,a={}){return this.getInstance(s)||new this(s,typeof a=="object"?a:null)}static get VERSION(){return Ct}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(s){return`${s}${this.EVENT_KEY}`}}const ie=t=>{let s=t.getAttribute("data-bs-target");if(!s||s==="#"){let a=t.getAttribute("href");if(!a||!a.includes("#")&&!a.startsWith("."))return null;a.includes("#")&&!a.startsWith("#")&&(a=`#${a.split("#")[1]}`),s=a&&a!=="#"?a.trim():null}return s?s.split(",").map(a=>we(a)).join(","):null},ee={find(t,s=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(s,t))},findOne(t,s=document.documentElement){return Element.prototype.querySelector.call(s,t)},children(t,s){return[].concat(...t.children).filter(a=>a.matches(s))},parents(t,s){const a=[];let n=t.parentNode.closest(s);for(;n;)a.push(n),n=n.parentNode.closest(s);return a},prev(t,s){let a=t.previousElementSibling;for(;a;){if(a.matches(s))return[a];a=a.previousElementSibling}return[]},next(t,s){let a=t.nextElementSibling;for(;a;){if(a.matches(s))return[a];a=a.nextElementSibling}return[]},focusableChildren(t){const s=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(a=>`${a}:not([tabindex^="-"])`).join(",");return this.find(s,t).filter(a=>!Se(a)&&ut(a))},getSelectorFromElement(t){const s=ie(t);return s&&ee.findOne(s)?s:null},getElementFromSelector(t){const s=ie(t);return s?ee.findOne(s):null},getMultipleElementsFromSelector(t){const s=ie(t);return s?ee.find(s):[]}},St=(t,s="hide")=>{const a=`click.dismiss${t.EVENT_KEY}`,n=t.NAME;k.on(document,a,`[data-bs-dismiss="${n}"]`,function(l){if(["A","AREA"].includes(this.tagName)&&l.preventDefault(),Se(this))return;const r=ee.getElementFromSelector(this)||this.closest(`.${n}`);t.getOrCreateInstance(r)[s]()})},Et="toast",kt="bs.toast",q=`.${kt}`,At=`mouseover${q}`,Dt=`mouseout${q}`,Rt=`focusin${q}`,Lt=`focusout${q}`,Ot=`hide${q}`,Ft=`hidden${q}`,Tt=`show${q}`,Mt=`shown${q}`,It="fade",Ce="hide",Z="show",X="showing",$t={animation:"boolean",autohide:"boolean",delay:"number"},qt={animation:!0,autohide:!0,delay:5e3};class W extends wt{constructor(s,a){super(s,a),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return qt}static get DefaultType(){return $t}static get NAME(){return Et}show(){if(k.trigger(this._element,Tt).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(It);const a=()=>{this._element.classList.remove(X),k.trigger(this._element,Mt),this._maybeScheduleHide()};this._element.classList.remove(Ce),mt(this._element),this._element.classList.add(Z,X),this._queueCallback(a,this._element,this._config.animation)}hide(){if(!this.isShown()||k.trigger(this._element,Ot).defaultPrevented)return;const a=()=>{this._element.classList.add(Ce),this._element.classList.remove(X,Z),k.trigger(this._element,Ft)};this._element.classList.add(X),this._queueCallback(a,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Z),super.dispose()}isShown(){return this._element.classList.contains(Z)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(s,a){switch(s.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=a;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=a;break}}if(a){this._clearTimeout();return}const n=s.relatedTarget;this._element===n||this._element.contains(n)||this._maybeScheduleHide()}_setListeners(){k.on(this._element,At,s=>this._onInteraction(s,!0)),k.on(this._element,Dt,s=>this._onInteraction(s,!1)),k.on(this._element,Rt,s=>this._onInteraction(s,!0)),k.on(this._element,Lt,s=>this._onInteraction(s,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(s){return this.each(function(){const a=W.getOrCreateInstance(this,s);if(typeof s=="string"){if(typeof a[s]>"u")throw new TypeError(`No method named "${s}"`);a[s](this)}})}}St(W);pt(W);const Fe=({data:t})=>{var a,n,l;const s=new Intl.NumberFormat("fr-FR",{currency:"MAD",style:"currency"});return e.jsx("div",{className:"table-responsive",id:"rapport-table-container-ac",children:e.jsxs("table",{className:"table table-bordered  table-bordered ",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"bg-light sticky-col",children:"Clients/Articles"}),(a=t.articles)==null?void 0:a.map((r,i)=>e.jsx("th",{className:"text-center bg-light",children:r},i)),e.jsx("th",{className:"text-center bg-light",children:"Chiffre d'affaire"}),e.jsx("th",{className:"text-center bg-light",children:"Montant Payé"})]})}),e.jsxs("tbody",{children:[(n=t.clients)==null?void 0:n.map((r,i)=>{var d,o,u,p,m;return e.jsxs("tr",{children:[e.jsx("th",{className:"bg-light sticky-col",children:r}),(d=t.articles)==null?void 0:d.map((h,j)=>{var f;return e.jsx("td",{className:"text-center",children:((f=t.data[r])==null?void 0:f[h])&&e.jsx("div",{className:"cell-content",children:e.jsx("div",{className:"quantity",children:t.data[r][h].quantite>0?t.data[r][h].quantite:""})})},j)}),e.jsx("td",{className:"text-center",children:s.format(((u=(o=t.client_totals)==null?void 0:o[r])==null?void 0:u.total_ttc)||0)}),e.jsx("td",{className:"text-center",children:s.format(((m=(p=t.client_totals)==null?void 0:p[r])==null?void 0:m.total_paye)||0)})]},i)}),!(((l=t.clients)==null?void 0:l.length)>0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:200,className:"text-center",children:"Aucune donnée trouvée"})})]})]})})},Pt=({data:t,isLoading:s,onPrint:a,onRefresh:n,onBack:l})=>{const r=c.useMemo(()=>t,[t]);return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header px-0 d-flex align-items-center",children:[e.jsxs("button",{className:"btn btn-sm btn-outline-secondary me-2",onClick:l,children:[e.jsx("i",{className:"fas fa-chevron-left me-1"})," Retour"]}),e.jsx("h5",{className:"mb-0",children:"Rapport de vente par article et client"})]}),e.jsx("div",{className:"card-body",children:s?e.jsx("div",{className:"text-center my-5",children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):e.jsx(Fe,{data:r})})]})},Vt=V.memo(Pt),Ht=({data:t,isLoading:s,onPrint:a,onRefresh:n,onBack:l})=>e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header px-0 d-flex align-items-center",children:[e.jsxs("button",{className:"btn btn-sm btn-outline-secondary me-2",onClick:l,children:[e.jsx("i",{className:"fas fa-chevron-left me-1"})," Retour"]}),e.jsx("h5",{className:"mb-0",children:"Rapport Stock"})]}),e.jsx("div",{className:"card-body",children:s?e.jsx("div",{className:"text-center my-5",children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):e.jsx("div",{className:"table-responsive",id:"rapport-table-container-as",children:e.jsxs("table",{className:"table table-striped table-bordered table-hover",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"bg-light",children:"Reference"}),e.jsx("th",{className:"bg-light",children:"Designation"}),e.jsx("th",{className:"bg-light",children:"Stock"})]})}),e.jsx("tbody",{children:t.map((r,i)=>e.jsxs("tr",{children:[e.jsx("td",{children:r.reference}),e.jsx("td",{children:r.designation}),e.jsx("td",{children:r.stock})]},i))})]})})})]}),zt=V.memo(Ht),Te=({data:t})=>{var s,a;return e.jsx("div",{className:"table-responsive",id:"rapport-table-container-af",children:e.jsxs("table",{className:"table table-striped table-bordered table-hover",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"bg-light sticky-col",children:"Fournisseurs/Articles"}),(s=t.articles)==null?void 0:s.map((n,l)=>e.jsx("th",{className:"text-center bg-light",children:n},l))]})}),e.jsxs("tbody",{children:[(a=t.fournisseurs)==null?void 0:a.map((n,l)=>{var r;return e.jsxs("tr",{children:[e.jsx("th",{className:"bg-light sticky-col",children:n}),(r=t.articles)==null?void 0:r.map((i,d)=>{var o;return e.jsx("td",{className:"text-center",children:((o=t.data[n])==null?void 0:o[i])&&e.jsx("div",{className:"cell-content",children:e.jsx("div",{className:"quantity",children:t.data[n][i].quantite>0?t.data[n][i].quantite:""})})},d)})]},l)}),t.fournisseurs.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:200,className:"text-center",children:"Aucune donnée trouvée"})})]})]})})},Kt=({data:t,isLoading:s,onPrint:a,onRefresh:n,onBack:l})=>{const r=c.useMemo(()=>t.data,[t]);return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header px-0 d-flex align-items-center",children:[e.jsxs("button",{className:"btn btn-sm btn-outline-secondary me-2",onClick:l,children:[e.jsx("i",{className:"fas fa-chevron-left me-1"})," Retour"]}),e.jsx("h5",{className:"mb-0",children:"Rapport Articles-Fournisseurs"})]}),e.jsx("div",{className:"card-body",children:s?e.jsx("div",{className:"text-center my-5",children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):e.jsx(Te,{data:r})})]})},Wt=V.memo(Kt),Me=({data:t,formatDate:s,formatCurrency:a})=>e.jsx("div",{className:"table-responsive",id:"rapport-table-container-cr",children:e.jsxs("table",{className:"table  table-bordered ",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"bg-light",children:"Référence"}),e.jsx("th",{className:"bg-light",children:"Client"}),e.jsx("th",{className:"bg-light",children:"Méthode de Paiement"}),e.jsx("th",{className:"bg-light",children:"Date de Paiement"}),e.jsx("th",{className:"bg-light",children:"N° Chèque/LCN"}),e.jsx("th",{className:"bg-light",children:"Date de Vente"}),e.jsx("th",{className:"bg-light",children:"Contrôlé"}),e.jsx("th",{className:"bg-light",children:"Montant Total"}),e.jsx("th",{className:"bg-light",children:"Montant Créance"})]})}),e.jsx("tbody",{children:t.length>0?t.map((n,l)=>{let r="";return n.statut_paiement==="non_paye"?r="bg-danger bg-opacity-25":n.statut_paiement==="partiellement_paye"?r="bg-primary bg-opacity-25":n.statut_paiement==="paye"&&(r="bg-success bg-opacity-25"),e.jsxs("tr",{className:r,children:[e.jsx("td",{children:n.reference||"-"}),e.jsx("td",{children:n.client_name||"-"}),e.jsx("td",{children:n.last_payment_method||"-"}),e.jsx("td",{children:s(n.last_payment_date)}),e.jsx("td",{children:n.cheque_lcn_reference||"-"}),e.jsx("td",{children:s(n.sale_date)}),e.jsx("td",{children:n.is_controled?e.jsx("span",{className:"badge bg-success",children:"Oui"}):e.jsx("span",{className:"badge bg-danger",children:"Non"})}),e.jsx("td",{className:"text-end",children:a(n.total_ttc)}),e.jsx("td",{className:"text-end",children:a(n.creance_amount)})]},l)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"9",className:"text-center",children:"Aucune créance trouvée"})})}),t.length>0&&e.jsx("tfoot",{children:e.jsxs("tr",{className:"bg-light",children:[e.jsx("th",{colSpan:"8",className:"text-end",children:"Total des Créances:"}),e.jsx("th",{className:"text-end",children:a(t.reduce((n,l)=>n+parseFloat(l.creance_amount||0),0))})]})})]})}),Bt=({data:t,isLoading:s,onPrint:a,onRefresh:n,onBack:l})=>{const r=c.useMemo(()=>t,[t]),i=o=>o||"-",d=o=>o==null?"-":new Intl.NumberFormat("fr-FR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(o);return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header px-0 d-flex align-items-center",children:[e.jsxs("button",{className:"btn btn-sm btn-outline-secondary me-2",onClick:l,children:[e.jsx("i",{className:"fas fa-chevron-left me-1"})," Retour"]}),e.jsx("h5",{className:"mb-0",children:"Rapport des Paiements et Créances"})]}),e.jsx("div",{className:"card-body",children:s?e.jsx("div",{className:"text-center my-5",children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):e.jsx(Me,{data:r,formatDate:i,formatCurrency:d})})]})},Yt=V.memo(Bt),Ie=({data:t,formatCurrency:s})=>e.jsx("div",{className:"table-responsive",id:"rapport-table-container-tr",children:e.jsxs("table",{className:"table table-striped table-bordered table-hover",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"bg-light",children:"Description"}),e.jsx("th",{className:"bg-light text-end",children:"Montant"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Total de Vente"})}),e.jsx("td",{className:"text-end",children:s(t.total_vente)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Total Espèce"})}),e.jsx("td",{className:"text-end",children:s(t.total_espece)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Total Chèque"})}),e.jsx("td",{className:"text-end",children:s(t.total_cheque)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Total LCN"})}),e.jsx("td",{className:"text-end",children:s(t.total_lcn)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Total Dépenses"})}),e.jsx("td",{className:"text-end",children:s(t.total_depenses)})]}),e.jsxs("tr",{className:"table-info",children:[e.jsx("td",{children:e.jsx("strong",{children:"Reste en Caisse"})}),e.jsx("td",{className:"text-end",children:e.jsx("strong",{children:s(t.reste_en_caisse)})})]})]})]})}),Ut=({data:t,isLoading:s,onPrint:a,onRefresh:n,onBack:l})=>{const r=c.useMemo(()=>t,[t]),i=d=>d==null?"-":new Intl.NumberFormat("fr-FR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(d);return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header px-0 d-flex align-items-center",children:[e.jsxs("button",{className:"btn btn-sm btn-outline-secondary me-2",onClick:l,children:[e.jsx("i",{style:{fontFamily:"Font Awesome 5 Free !important",fontWeight:900,marginRight:"0.25rem"},className:"fa-chevron-left"})," Retour"]}),e.jsx("h5",{className:"mb-0",children:"Rapport de Trésorerie"})]}),e.jsx("div",{className:"card-body",children:s?e.jsx("div",{className:"text-center my-5",children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):e.jsx(Ie,{data:r,formatCurrency:i})})]})},Qt=V.memo(Ut),Jt=({onBack:t,onPrint:s})=>{const[a,n]=c.useState(!0),[l,r]=c.useState({articlesClients:{clients:[],articles:[],data:{}},articlesFournisseurs:{fournisseurs:[],articles:[],data:{}},creance:[],tresorie:{}});c.useEffect(()=>{i()},[]);const i=async()=>{n(!0);try{const[u,p,m,h]=await Promise.all([T.post("articles-clients-rapport",{session_id:__session_id}),T.post("articles-fournisseurs-rapport",{session_id:__session_id}),T.post("creance-rapport",{session_id:__session_id}),T.post("tresorie-rapport",{session_id:__session_id})]);r({articlesClients:u.data,articlesFournisseurs:p.data,creance:m.data,tresorie:h.data})}catch(u){console.error("Error fetching rapport data:",u)}finally{n(!1)}},d=u=>u||"-",o=u=>u==null?"-":new Intl.NumberFormat("fr-FR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(u);return e.jsxs("div",{className:"card ",children:[e.jsxs("div",{className:"card-header px-0 d-flex align-items-center",children:[e.jsxs("button",{className:"btn btn-sm btn-outline-secondary me-2",onClick:t,children:[e.jsx("i",{style:{fontFamily:"Font Awesome 5 Free !important",fontWeight:900,marginRight:"0.25rem"},className:"fa-chevron-left"})," Retour"]}),e.jsx("h5",{className:"mb-0",children:"Rapport Journalier"})]}),e.jsx("div",{className:"card-body",children:a?e.jsx("div",{className:"text-center my-5",children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):e.jsxs("div",{className:"row",id:"journlaier-tables",children:[__rapport_ac_enabled==1&&e.jsxs("div",{className:"col-12 mb-4",children:[e.jsx("h4",{children:"Rapport de vente par article et client"}),e.jsx(Fe,{data:l.articlesClients})]}),__rapport_af_enabled==1&&e.jsxs("div",{className:"col-12 mb-4",children:[e.jsx("h4",{children:"Rapport Articles-Fournisseurs"}),e.jsx(Te,{data:l.articlesFournisseurs})]}),__rapport_cr_enabled==1&&e.jsxs("div",{className:"col-12 mb-4",children:[e.jsx("h4",{children:"Rapport des Paiements et Créances"}),e.jsx(Me,{data:l.creance,formatDate:d,formatCurrency:o})]}),__rapport_tr_enabled==1&&e.jsxs("div",{className:"col-12 mb-4",children:[e.jsx("h4",{children:"Rapport de Trésorerie"}),e.jsx(Ie,{data:l.tresorie,formatCurrency:o})]})]})})]})},Gt=V.memo(Jt),Zt=()=>{const[t,s]=c.useState(null),[a,n]=c.useState({ac:{clients:[],articles:[],data:{},isLoading:!1},as:{data:[],isLoading:!1},af:{fournisseurs:[],articles:[],data:{},isLoading:!1},cr:{data:[],isLoading:!1},tr:{data:{},isLoading:!1}}),l=c.useMemo(()=>a.ac,[a.ac]),r=c.useMemo(()=>a.as.data,[a.as.data]),i=c.useMemo(()=>a.af,[a.af]),d=c.useMemo(()=>a.cr.data,[a.cr.data]),o=c.useMemo(()=>a.tr.data,[a.tr.data]),u=c.useMemo(()=>a.ac.isLoading,[a.ac.isLoading]),p=c.useMemo(()=>a.as.isLoading,[a.as.isLoading]),m=c.useMemo(()=>a.af.isLoading,[a.af.isLoading]),h=c.useMemo(()=>a.cr.isLoading,[a.cr.isLoading]),j=c.useMemo(()=>a.tr.isLoading,[a.tr.isLoading]),f=c.useCallback(x=>{let C,E;x==="ac"?(C="articles-clients-rapport",E=u):x==="af"?(C="articles-fournisseurs-rapport",E=m):x==="cr"?(C="creance-rapport",E=h):x==="tr"?(C="tresorie-rapport",E=j):(C="articles-stock-rapport",E=p),!E&&(n(N=>({...N,[x]:{...N[x],isLoading:!0}})),T.post(C,{session_id:__session_id}).then(N=>{n(P=>({...P,[x]:{...x==="ac"?N.data:{data:N.data},isLoading:!1}}))}).catch(N=>{var P,Q;n(z=>({...z,[x]:{...z[x],isLoading:!1}})),W.show(((Q=(P=N.response)==null?void 0:P.data)==null?void 0:Q.message)||"Error loading data")}))},[u,p,m,h]),v=c.useCallback(()=>f("ac"),[f]),D=c.useCallback(()=>f("as"),[f]),O=c.useCallback(()=>f("af"),[f]),A=c.useCallback(()=>f("cr"),[f]),R=c.useCallback(()=>f("tr"),[f]),H=c.useCallback(()=>f("jr"),[f]),g=c.useCallback((x,C)=>{const E=document.getElementById(x).innerHTML,N=window.open("","_blank");if(!N){W.show("Please allow pop-ups for printing");return}N.document.write(`
            <html>
                <head>
                    <title>${C}</title>
                    <style>
                        @page { size: A4; margin: 1cm; }
                        @media print {
                            body { margin: 0; padding: 0; font-size: 12px; }
                            .table { width: 100%; border-collapse: collapse; font-size: 10px; }
                            .table th, .table td { border: 1px solid #dee2e6; padding: 4px; text-align: center; }
                            .cell-content { page-break-inside: avoid; }
                            .print-header { position: relative; text-align: center; margin-bottom: 20px; padding: 10px; }
                            .print-header h1 { font-size: 16px; margin: 0; }
                            .print-header .print-date { font-size: 12px; color: #666; }
                            .print-meta { position: absolute; right: 10px; top: 10px; text-align: right; font-size: 12px; color: #333; }
                            .print-meta .line { white-space: nowrap; }
                            .page-break { page-break-after: always; }
                            .no-print { display: none !important; }
                        }
                    </style>
                </head>
                <body>
                    <div class="print-header">
                        <div class="print-meta">
                            <div class="line"><strong>Magasin:</strong> ${__magasin_ref}</div>
                            <div class="line"><strong>Vendeur:</strong> ${__vendeur_nom}</div>
                        </div>
                        <h1>${C}</h1>
                        <div class="print-date">
                            Date d'impression: ${new Date().toLocaleString("fr-FR")}
                        </div>
                    </div>
                    ${E}
                </body>
            </html>
        `),N.document.close(),N.focus(),N.onload=function(){N.print(),N.close()}},[]),b=c.useCallback(()=>{g("rapport-table-container-ac","Rapport de vente par article et client")},[g]),_=c.useCallback(()=>{g("rapport-table-container-as","Rapport Articles Stock")},[g]),S=c.useCallback(()=>{g("rapport-table-container-af","Rapport Articles-Fournisseurs")},[g]),L=c.useCallback(()=>{g("rapport-table-container-cr","Rapport des Créances")},[g]),y=c.useCallback(()=>{g("rapport-table-container-tr","Rapport de Trésorerie")},[g]),M=c.useCallback(x=>{s(x),x==="ac"?v():x==="as"?D():x==="af"?O():x==="cr"?A():x==="tr"?R():x==="jr"&&(D(),O(),A(),R())},[v,D,O,A,R]);return c.useMemo(()=>x=>new Intl.NumberFormat("fr-FR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(x),[]),e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-soft-primary mx-1","data-bs-target":"#rapports-modal","data-bs-toggle":"modal",children:e.jsx("i",{className:"fa fa-file-alt",children:" Rapports"})}),e.jsx("div",{className:"modal fade",id:"rapports-modal",tabIndex:"-1","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog modal-fullscreen",children:e.jsxs("div",{className:"modal-content bg-body",children:[e.jsxs("div",{className:"modal-header border-0 bg-body",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("button",{type:"button","data-bs-dismiss":"modal",className:"text-primary h3 me-3 mb-0 border-0 bg-transparent",children:e.jsx("i",{className:"fa fa-arrow-left"})}),e.jsx("h3",{className:"modal-title mb-0",children:"Rapports"})]}),e.jsxs("div",{className:"ms-auto",children:[t==="ac"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"btn btn-success me-2",onClick:b,disabled:u,children:[e.jsx("i",{className:"fas fa-print me-1"}),"Imprimer"]}),e.jsxs("button",{className:"btn btn-primary me-2",onClick:v,disabled:u,children:[e.jsx("i",{className:"fas fa-sync-alt me-1"}),"Actualiser"]})]}),t==="as"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"btn btn-success me-2",onClick:_,disabled:p,children:[e.jsx("i",{className:"fas fa-print me-1"}),"Imprimer"]}),e.jsxs("button",{className:"btn btn-primary me-2",onClick:D,disabled:p,children:[e.jsx("i",{className:"fas fa-sync-alt me-1"}),"Actualiser"]})]}),t==="af"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"btn btn-success me-2",onClick:S,disabled:m,children:[e.jsx("i",{className:"fas fa-print me-1"}),"Imprimer"]}),e.jsxs("button",{className:"btn btn-primary me-2",onClick:O,disabled:m,children:[e.jsx("i",{className:"fas fa-sync-alt me-1"}),"Actualiser"]})]}),t==="cr"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"btn btn-success me-2",onClick:L,disabled:h,children:[e.jsx("i",{className:"fas fa-print me-1"}),"Imprimer"]}),e.jsxs("button",{className:"btn btn-primary me-2",onClick:A,disabled:h,children:[e.jsx("i",{className:"fas fa-sync-alt me-1"}),"Actualiser"]})]}),t==="tr"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"btn btn-success me-2",onClick:y,disabled:j,children:[e.jsx("i",{className:"fas fa-print me-1"}),"Imprimer"]}),e.jsxs("button",{className:"btn btn-primary me-2",onClick:R,disabled:j,children:[e.jsx("i",{className:"fas fa-sync-alt me-1"}),"Actualiser"]})]}),t==="jr"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"btn btn-success me-2",onClick:()=>g("journlaier-tables","Rapport Journalier"),disabled:j,children:[e.jsx("i",{className:"fas fa-print me-1"}),"Imprimer"]}),e.jsxs("button",{className:"btn btn-primary me-2",onClick:H,children:[e.jsx("i",{className:"fas fa-sync-alt me-1"}),"Actualiser"]})]})]})]}),e.jsx("div",{className:"modal-body p-4",children:e.jsxs("div",{className:"container-fluid px-0",children:[!t&&e.jsxs("div",{className:"row",children:[__rapport_as_enabled==1&&e.jsx("div",{className:"col-md-6 mb-4",children:e.jsx("div",{className:"card card-rapport h-100",onClick:()=>M("as"),children:e.jsxs("div",{className:"card-body d-flex flex-column",children:[e.jsx("h5",{className:"card-title",children:"Rapport Stock"}),e.jsx("p",{className:"card-text flex-grow-1",children:"Affiche un rapport détaillé du stock disponible pour chaque article."})]})})}),e.jsxs("div",{className:"col-12",children:[e.jsx("h4",{children:"Rapports journalier"}),e.jsx("hr",{className:"border border-primary"})]}),__rapport_ac_enabled==1&&e.jsx("div",{className:"col-md-6 mb-4",children:e.jsx("div",{className:"card card-rapport h-100",onClick:()=>M("ac"),children:e.jsxs("div",{className:"card-body d-flex flex-column",children:[e.jsx("h5",{className:"card-title",children:"Rapport de vente par article et client"}),e.jsx("p",{className:"card-text flex-grow-1",children:"Affiche un rapport détaillé des articles achetés par chaque client."})]})})}),__rapport_af_enabled==1&&e.jsx("div",{className:"col-md-6 mb-4",children:e.jsx("div",{className:"card card-rapport h-100",onClick:()=>M("af"),children:e.jsxs("div",{className:"card-body d-flex flex-column",children:[e.jsx("h5",{className:"card-title",children:"Rapport Articles-Fournisseurs"}),e.jsx("p",{className:"card-text flex-grow-1",children:"Affiche un rapport détaillé des articles achetés auprès de chaque fournisseur."})]})})}),__rapport_cr_enabled==1&&e.jsx("div",{className:"col-md-6 mb-4",children:e.jsx("div",{className:"card card-rapport h-100",onClick:()=>M("cr"),children:e.jsxs("div",{className:"card-body d-flex flex-column",children:[e.jsx("h5",{className:"card-title",children:"Rapport des Paiements et Créances"}),e.jsx("p",{className:"card-text flex-grow-1",children:"Affiche un rapport détaillé des ventes non payées ou partiellement payées."})]})})}),__rapport_tr_enabled==1&&e.jsx("div",{className:"col-md-6 mb-4",children:e.jsx("div",{className:"card card-rapport h-100",onClick:()=>M("tr"),children:e.jsxs("div",{className:"card-body d-flex flex-column",children:[e.jsx("h5",{className:"card-title",children:"Rapport de Trésorerie"}),e.jsx("p",{className:"card-text flex-grow-1",children:"Affiche un résumé de la trésorerie de la session: ventes, espèces, chèques, LCN, dépenses et reste en caisse."})]})})}),(__rapport_tr_enabled||__rapport_cr_enabled||__rapport_af_enabled||__rapport_ac_enabled)==1&&e.jsx("div",{className:"col-md-6 mb-4",children:e.jsx("div",{className:"card card-rapport h-100",onClick:()=>M("jr"),children:e.jsxs("div",{className:"card-body d-flex flex-column",children:[e.jsx("h5",{className:"card-title",children:"Rapport Journalier"}),e.jsx("p",{className:"card-text flex-grow-1",children:"Afficher tous les rapports journalier."})]})})})]}),t==="ac"&&e.jsx(Vt,{data:l,isLoading:u,onPrint:b,onRefresh:v,onBack:()=>s(null)}),t==="as"&&e.jsx(zt,{data:r,isLoading:p,onPrint:_,onRefresh:D,onBack:()=>s(null)}),t==="af"&&e.jsx(Wt,{data:i,isLoading:m,onPrint:S,onRefresh:O,onBack:()=>s(null)}),t==="cr"&&e.jsx(Yt,{data:d,isLoading:h,onPrint:L,onRefresh:A,onBack:()=>s(null)}),t==="tr"&&e.jsx(Qt,{data:o,isLoading:j,onPrint:y,onRefresh:R,onBack:()=>s(null)}),t==="jr"&&e.jsx(Gt,{onBack:()=>s(null),onPrint:g})]})})]})})}),e.jsx("style",{children:`
                    .card-rapport{
                        cursor: pointer;
                        transition: background-color 0.2s ease;
                    }
                    .card-rapport:hover{
                        background-color: #f8f9fa;
                    }
                    #rapports-modal .modal-fullscreen {
                        padding: 0 !important;
                    }

                    #rapports-modal .modal-fullscreen .modal-content {
                        min-height: 100vh;
                    }

                    #rapports-modal .sticky-col {
                        position: sticky;
                        left: 0;
                        z-index: 1;
                    }

                    #rapports-modal .cell-content {
                        padding: 5px;
                    }

                    #rapports-modal .cell-content .quantity {
                        font-weight: 500;
                        color: #495057;
                    }

                    #rapports-modal .cell-content .amount {
                        color: #6c757d;
                        font-size: 0.9em;
                    }

                    #rapport-table-container-ac .table th,
                    #rapport-table-container-as .table th,
                    #rapport-table-container-af .table th,
                    #rapport-table-container-cr .table th,
                    #rapport-table-container-tr .table th {
                        background-color: #f8f9fa;
                        white-space: nowrap;
                    }

                    #rapport-table-container-ac .table td,
                    #rapport-table-container-as .table td,
                    #rapport-table-container-af .table td,
                    #rapport-table-container-cr .table td,
                    #rapport-table-container-tr .table td {
                        vertical-align: middle;
                    }

                    #rapports-modal .modal-header {
                        background-color: #fff;
                        position: sticky;
                        top: 0;
                        z-index: 1050;
                    }
                `})]})},rs=V.memo(Zt);export{ts as A,as as C,ns as H,ss as P,rs as R};
