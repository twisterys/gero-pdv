import{_ as Qe,r as c,c as O,h as Je,d as G,e as Ge,u as Ze,S as Xe,f as et,j as e,g as be,a as I,b as V}from"./react-select.esm-AIjEkChc.js";var tt=["defaultOptions","cacheOptions","loadOptions","options","isLoading","onInputChange","filterOption"];function st(t){var s=t.defaultOptions,a=s===void 0?!1:s,n=t.cacheOptions,l=n===void 0?!1:n,r=t.loadOptions;t.options;var i=t.isLoading,d=i===void 0?!1:i,o=t.onInputChange,u=t.filterOption,x=u===void 0?null:u,m=Qe(t,tt),p=m.inputValue,g=c.useRef(void 0),b=c.useRef(!1),N=c.useState(Array.isArray(a)?a:void 0),E=O(N,2),k=E[0],A=E[1],R=c.useState(typeof p<"u"?p:""),v=O(R,2),f=v[0],L=v[1],D=c.useState(a===!0),w=O(D,2),U=w[0],T=w[1],F=c.useState(void 0),h=O(F,2),_=h[0],C=h[1],j=c.useState([]),P=O(j,2),Q=P[0],H=P[1],Ie=c.useState(!1),he=O(Ie,2),qe=he[0],J=he[1],$e=c.useState({}),me=O($e,2),W=me[0],pe=me[1],Pe=c.useState(void 0),fe=O(Pe,2),Ve=fe[0],He=fe[1],ze=c.useState(void 0),xe=O(ze,2),Ke=xe[0],We=xe[1];l!==Ke&&(pe({}),We(l)),a!==Ve&&(A(Array.isArray(a)?a:void 0),He(a)),c.useEffect(function(){return b.current=!0,function(){b.current=!1}},[]);var te=c.useCallback(function(B,z){if(!r)return z();var y=r(B,z);y&&typeof y.then=="function"&&y.then(z,function(){return z()})},[r]);c.useEffect(function(){a===!0&&te(f,function(B){b.current&&(A(B||[]),T(!!g.current))})},[]);var Be=c.useCallback(function(B,z){var y=Je(B,z,o);if(!y){g.current=void 0,L(""),C(""),H([]),T(!1),J(!1);return}if(l&&W[y])L(y),C(y),H(W[y]),T(!1),J(!1);else{var Ue=g.current={};L(y),T(!0),J(!_),te(y,function(se){b&&Ue===g.current&&(g.current=void 0,T(!1),C(y),H(se||[]),J(!1),pe(se?G(G({},W),{},Ge({},y,se)):W))})}},[l,te,_,W,o]),Ye=qe?[]:f&&_?Q:k||[];return G(G({},m),{},{options:Ye,isLoading:U||d,onInputChange:Be,filterOption:x})}var at=c.forwardRef(function(t,s){var a=st(t),n=Ze(a);return c.createElement(Xe,et({ref:s},n))}),es=at;const ts=({paiement:t,setPaiement:s,payer:a})=>e.jsx("div",{className:"modal fade","data-bs-backdrop":"static",tabindex:"-1",id:"paiement-modal",style:{display:"none"},children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title align-self-center",children:"Paiement"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"col-12 mt-3",style:{display:"none"},children:[e.jsx("label",{htmlFor:"date_paiement",className:"form-label required",children:"Date de paiement"}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{required:!0,className:"form-control datupickeru","data-provide":"datepicker","data-date-autoclose":"true",type:"text",id:"date_paiement",value:t.i_date_paiement,onChange:n=>s({...t,i_date_paiement:document.querySelector("#date_paiement").value,i_date:document.querySelector("#date_prevu").value})}),e.jsx("span",{className:"input-group-text",children:e.jsx("i",{className:"fa fa-calendar-alt"})})]})]}),e.jsxs("div",{className:"col-12 mt-3",children:[e.jsx("label",{htmlFor:"montant",className:"form-label required",children:"Montant de paiement"}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{required:!0,className:"form-control",step:"0.01",min:"1",max:t.i_montant,type:"number",value:t.i_montant,onChange:n=>s({...t,i_montant:n.target.value,i_date_paiement:document.querySelector("#date_paiement").value,i_date:document.querySelector("#date_prevu").value}),id:"montant"}),e.jsx("span",{className:"input-group-text",children:"MAD"})]})]}),e.jsxs("div",{className:"col-12 mt-3",children:[e.jsx("label",{htmlFor:"compte-input",className:"form-label required",children:"Compte"}),e.jsx(be,{classNames:{control:()=>"border-light shadow-none",option:n=>n.isFocused?"bg-primary text-white":n.isSelected?"bg-soft-primary text-white":n.isDisabled?"bg-soft-light text-muted":"",singleValue:n=>{n.isFocused}},cache:!1,value:t.i_compte_id,onChange:n=>s({...t,i_compte_id:n,i_date_paiement:document.querySelector("#date_paiement").value,i_date:document.querySelector("#date_prevu").value}),options:__comptes})]}),e.jsxs("div",{className:"col-12 mt-3",children:[e.jsx("label",{htmlFor:"method-input",className:"form-label required",children:"Méthode de paiement"}),e.jsx(be,{classNames:{control:()=>"border-light shadow-none",option:n=>n.isFocused?"bg-primary text-white":n.isSelected?"bg-soft-primary text-white":n.isDisabled?"bg-soft-light text-muted":"",singleValue:n=>{n.isFocused}},cache:!1,value:t.i_method_key,onChange:n=>{s({...t,i_method_key:n,i_date_paiement:document.querySelector("#date_paiement").value,i_date:document.querySelector("#date_prevu").value})},options:__methodes})]}),e.jsxs("div",{className:"col-12 mt-3",style:{display:t.i_method_key.value==="cheque"||t.i_method_key.value==="lcn"?"":"none"},children:[e.jsx("label",{htmlFor:"date",className:"form-label required",children:"Date prévu"}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{required:!0,className:"form-control datupickeru","data-provide":"datepicker","data-date-autoclose":"true",type:"text",id:"date_prevu",value:t.i_date,onChange:n=>s({...t,i_date_paiement:document.querySelector("#date_paiement").value,i_date:document.querySelector("#date_prevu").value})}),e.jsx("span",{className:"input-group-text",children:e.jsx("i",{className:"fa fa-calendar-alt"})})]})]}),e.jsxs("div",{className:"col-12 mt-3 ",style:{display:t.i_method_key.value==="cheque"||t.i_method_key.value==="lcn"?" ":"none"},children:[e.jsx("label",{htmlFor:"i_reference",className:"form-label required",children:"Référence de chéque"}),e.jsx("input",{required:!0,className:"form-control",type:"text",value:t.i_reference,onChange:n=>s({...t,i_reference:n.target.value,i_date_paiement:document.querySelector("#date_paiement").value,i_date:document.querySelector("#date_prevu").value})})]}),e.jsxs("div",{className:"col-12 mt-3",children:[e.jsx("label",{htmlFor:"i_note",className:"form-label",children:"Note"}),e.jsx("textarea",{className:"form-control",rows:"3",value:t.i_note,onChange:n=>s({...t,i_note:n.target.value,i_date_paiement:document.querySelector("#date_paiement").value,i_date:document.querySelector("#date_prevu").value})})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-light","data-bs-dismiss":"modal",children:"Fermer"}),e.jsx("button",{className:"btn btn-info",onClick:()=>a(),children:"Payer"})]})]})})}),ss=({setClient:t,setIsLoading:s})=>{const[a,n]=c.useState({city:null,nom:null,telephone:null,adresse:null}),l=()=>{s(!0),I.post("clients",{...a}).then(r=>{t(r.data.client),s(!1),toastr.success(r.data.message),$("#client-modal").modal("hide"),n({city:null,nom:null,telephone:null,adresse:null})}).catch(r=>{if(s(!1),r.response.status==422){let i=r.response.data.errors,d="";for(let o in i)d+=`<p class="text-white">${i[o][0]}</p>`;toastr.warning(d)}else toastr.error("Vuillez ressayer plus tard")})};return e.jsx("div",{class:"modal fade ",id:"client-modal",tabindex:"-1","aria-hidden":"true",style:{display:"none"},children:e.jsx("div",{class:"modal-dialog  modal-dialog-centered",children:e.jsxs("div",{class:"modal-content ",children:[e.jsxs("div",{class:"modal-header",children:[e.jsx("h5",{class:"modal-title align-self-center",id:"edit-cat-modal-title",children:"Ajout rapide de client"}),e.jsx("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),e.jsxs("div",{class:"row px-3 align-items-start pt-4",children:[e.jsxs("div",{class:"col-12  mb-3",children:[e.jsx("label",{for:"nom",class:"form-label required",id:"dynamic_label",children:"Dénomination"}),e.jsx("input",{type:"text",class:"form-control ",id:"nom",name:"nom",required:!0,value:a.nom,onChange:r=>n({...a,nom:r.target.value}),placeholder:"Nom du client"})]}),e.jsxs("div",{class:"col-12 mb-3",children:[e.jsx("label",{for:"telephone",class:"form-label",children:"Téléphone"}),e.jsx("input",{type:"tel",class:"form-control",id:"telephone",name:"telephone",value:a.telephone,onChange:r=>n({...a,telephone:r.target.value}),placeholder:"Numéro de téléphone"})]}),e.jsxs("div",{class:"col-12  mb-3",children:[e.jsx("label",{for:"city",class:"form-label",children:"Ville"}),e.jsx("input",{type:"text",className:"form-control",value:a.city,id:"city",onChange:r=>n({...a,city:r.target.value}),placeholder:"Ville du client"})]})]}),e.jsxs("div",{class:"modal-footer",children:[e.jsx("button",{type:"button",class:"btn btn-light","data-bs-dismiss":"modal",children:"Fermer"}),e.jsx("button",{onClick:()=>l(),type:"button",id:"add-btn-client",class:"btn btn-primary",children:"Enregistrer"})]})]})})})},je=({item:t,setHistory:s})=>{const a=l=>{I.get("ventes/ticket/"+l).then(r=>{n(r.data)}).catch(r=>{})};function n(l){document.getElementById("iframe")&&document.getElementById("iframe").remove();let r=document.createElement("iframe");r.style.display="none",r.id="iframe",r.srcdoc=l,document.body.append(r),r.contentWindow.focus(),r.contentWindow.print()}return e.jsx("a",{className:"col-12","data-bs-dismiss":"offcanvas",children:e.jsxs("div",{className:"card py-0 border flex-row",children:[e.jsx("div",{className:"card-body py-2",onClick:()=>{s(t),setTimeout(()=>{$("#history-modal").modal("show")},500)},children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h5",{className:"text-black-50 col-4 m-0",children:t.reference}),e.jsx("h5",{className:"text-black-50 col-4 m-0",children:t.time}),e.jsx("h5",{className:"m-0 col-4 text-end",children:t.total})]})}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>a(t.id),children:[" ",e.jsx("i",{className:"fa fa-print"})," "]})]})},t.id)},nt=({item:t,reduction:s})=>e.jsx("div",{class:"modal fade","data-bs-backdrop":"static",tabindex:"-1",id:"history-modal",style:{display:"none"},children:e.jsx("div",{class:"modal-dialog modal-dialog-centered modal-lg",children:t?e.jsxs("div",{class:"modal-content",children:[e.jsxs("div",{class:"modal-header",children:[e.jsxs("h5",{class:"modal-title align-self-center",children:[t.type," ",t.reference]}),e.jsx("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),e.jsxs("div",{class:"modal-body",children:[e.jsxs("div",{class:"row py-1 px-1 mx-0",children:[e.jsxs("div",{class:" col-sm-6 col-md-4 mt-3 d-flex align-items-center",children:[e.jsx("div",{class:"rounded bg-soft-info  p-2 d-flex align-items-center justify-content-center",style:{width:"49px"},children:e.jsx("i",{class:"fa fa-id-card fa-2x"})}),e.jsxs("div",{class:"ms-3 ",children:[e.jsx("span",{class:"font-weight-bolder font-size-sm",children:"Reference"}),e.jsx("p",{class:"mb-0 h5 text-black",children:t.reference})]})]}),e.jsxs("div",{class:" col-sm-6 col-md-4 mt-3 d-flex align-items-center",children:[e.jsx("div",{class:"rounded bg-soft-success  p-2 d-flex align-items-center justify-content-center",style:{width:"49px"},children:e.jsx("i",{class:"fa fa-building fa-2x"})}),e.jsxs("div",{class:"ms-3 ",children:[e.jsx("span",{class:"font-weight-bolder font-size-sm",children:"Client"}),e.jsx("p",{class:"mb-0 h5 text-black text-capitalize",children:t.client_nom})]})]}),e.jsxs("div",{class:" col-sm-6 col-md-4   mt-3  d-flex align-items-center",children:[e.jsx("div",{class:"rounded bg-soft-danger p-2 d-flex align-items-center justify-content-center",style:{width:"49px"},children:e.jsx("i",{class:"fa fa-calendar-alt fa-2x"})}),e.jsxs("div",{class:"ms-3 ",children:[e.jsx("span",{class:"font-weight-bolder font-size-sm",children:"Date d'emission"}),e.jsx("p",{class:"mb-0 h5 text-black text-capitalize",children:t.time})]})]}),e.jsxs("div",{class:" col-sm-6 col-md-4 mt-3 d-flex align-items-center",children:[e.jsx("div",{class:"rounded bg-soft-warning  p-2 d-flex align-items-center justify-content-center",style:{width:"49px"},children:e.jsx("i",{class:"fa fa-star fa-2x"})}),e.jsxs("div",{class:"ms-3 ",children:[e.jsx("span",{class:"font-weight-bolder font-size-sm",children:"Statut"}),e.jsx("p",{class:"mb-0 h5 text-black text-capitalize",children:t.statut})]})]}),e.jsxs("div",{class:" col-sm-6 col-md-4  mt-3 d-flex align-items-md-start",children:[e.jsx("div",{class:"rounded bg-soft-purple p-2 d-flex align-items-center justify-content-center",style:{width:"49px"},children:e.jsx("i",{class:"fa fa-coins fa-2x"})}),e.jsxs("div",{class:"ms-3 ",children:[e.jsxs("span",{class:"font-weight-bolder font-size-sm",children:["Montant TTC"," "]}),e.jsx("p",{class:"mb-0 h5 text-black text-capitalize",children:t.total})]})]})]}),e.jsxs("table",{className:"table table-bordered table-striped mt-3",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-primary text-white",children:[e.jsx("th",{className:"text-white",children:"Produit"}),e.jsx("th",{className:"text-white",children:"Quantité"}),e.jsx("th",{className:"text-white",children:"Prix"}),s?e.jsx("th",{className:"text-white",children:"Reduction"}):"",e.jsx("th",{className:"text-white",children:"Total"})]})}),e.jsx("tbody",{children:t.lignes.map((a,n)=>e.jsxs("tr",{children:[e.jsx("td",{children:a.article}),e.jsxs("td",{children:[a.quantity," ",a.unite]}),e.jsx("td",{children:a.price}),s?e.jsx("td",{children:a.reduction}):"",e.jsx("td",{children:a.total_ttc})]},n))})]})]}),e.jsx("div",{class:"modal-footer",children:e.jsx("button",{type:"button",class:"btn btn-light","data-bs-dismiss":"modal",children:"Fermer"})})]}):""})}),rt=({item:t})=>e.jsx("div",{className:"col-6",children:e.jsx("div",{className:"card border",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h5",{className:"text-black-50",children:t.reference}),e.jsx("h5",{className:"text-black-50",children:t.date})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h5",{className:"m-0",children:e.jsx("span",{className:"text-black-50",children:"Dépense:"})}),e.jsx("h5",{className:"m-0",children:t.nom})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h5",{className:"m-0",children:e.jsx("span",{className:"text-black-50",children:"Bénéficiaire:"})}),e.jsx("h5",{className:"m-0",children:t.beneficiaire})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h5",{className:"m-0",children:e.jsx("span",{className:"text-black-50",children:"Catégorie:"})}),e.jsx("h5",{className:"m-0",children:t.category})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h5",{className:"m-0",children:e.jsx("span",{className:"text-black-50",children:"Montant TTC:"})}),e.jsxs("h5",{className:"m-0",children:[t.total," MAD"]})]})]})})},t.id),as=({reduction:t})=>{const[s,a]=c.useState([]),[n,l]=c.useState([]),[r,i]=c.useState(null),[d,o]=c.useState(!1),[u,x]=c.useState([]),[m,p]=c.useState("ventes"),g=()=>s.length>0?s.map(v=>e.jsx(je,{setHistory:i,item:v})):e.jsx("h5",{className:"text-center",children:"Aucun vente"}),b=()=>n.length>0?n.map(v=>e.jsx(je,{setHistory:i,item:v})):e.jsx("h5",{className:"text-center",children:"Aucun retour"}),N=()=>u.length>0?u.map(v=>e.jsx(rt,{item:v})):e.jsx("h5",{className:"text-center",children:"Aucune dépense"}),[E,k]=c.useState(!1),A=()=>{let v=s.reduce((D,w)=>+D+parseInt(w.total_ttc,10),0),f=u.reduce((D,w)=>+D+parseInt(w.total,10),0),L=n.reduce((D,w)=>+D+parseInt(w.total,10),0);return e.jsxs(e.Fragment,{children:[e.jsxs("h5",{className:"m-0",children:["Total Ventes: ",v.toFixed(2)+" MAD"]}),e.jsxs("h5",{className:"m-0",children:["Total Retours: ",L.toFixed(2)+" MAD"]}),e.jsxs("h5",{className:"m-0",children:["Total Dépenses: ",f.toFixed(2)+" MAD"]}),e.jsxs("h5",{className:"m-0",children:["Total : ",(v-L-f).toFixed(2)+" MAD"]})]})},R=()=>{if(E)return;k(!0);let v={session_id:__session_id};I.get("history",{params:v}).then(f=>{a(f.data.ventes),l(f.data.retours),x(f.data.depenses),console.log(f.data.depenses),k(!1)})};return $(document).on("show.bs.offcanvas","#offcanvasExample",function(){o(!0)}),$(document).on("hide.bs.offcanvas","#offcanvasExample",function(){o(!1)}),c.useEffect(()=>{d&&R()},[d]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"offcanvas offcanvas-end",tabindex:"-1",id:"offcanvasExample","aria-labelledby":"offcanvasExampleLabel",style:{width:"800px"},children:[e.jsxs("div",{class:"offcanvas-header",children:[e.jsx("h5",{class:"offcanvas-title",id:"offcanvasExampleLabel",children:"Historique"}),e.jsx("button",{type:"button",class:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close"})]}),e.jsxs("div",{class:"offcanvas-body d-flex flex-column",children:[e.jsxs("div",{className:"d-flex",children:[e.jsx("button",{className:m==="ventes"?"btn btn-light me-2 mb-2 history-tab active":"btn btn-light me-2 mb-2  history-tab",onClick:()=>p("ventes"),children:"Vente"}),e.jsx("button",{className:m==="retours"?"btn btn-light me-2 mb-2 history-tab active":"btn btn-light me-2 mb-2  history-tab",onClick:()=>p("retours"),children:"Retours"}),e.jsx("button",{className:m==="depenses"?"btn btn-light me-2 mb-2 history-tab active":"btn btn-light me-2 mb-2  history-tab",onClick:()=>p("depenses"),children:"Dépenses"})]}),e.jsxs("div",{className:"card shadow-none flex-grow-1 d-flex flex-column",children:[e.jsx("div",{className:"card-body flex-grow-1",children:E?e.jsx("div",{className:"d-flex align-items-center justify-content-center",children:e.jsx("div",{class:"spinner-border",role:"status"})}):m==="ventes"?e.jsx("div",{className:"row",children:g()}):m==="depenses"?e.jsx("div",{className:"row",children:N()}):m==="retours"?e.jsx("div",{className:"row",children:b()}):""}),e.jsxs("div",{className:"card-body border-top border-light flex-grow-0 d-flex align-baseline justify-content-between",children:[e.jsx("div",{children:A()}),e.jsxs("p",{children:["Ouverture de session: ",__ouverture]})]})]})]})]}),e.jsx(nt,{reduction:t,item:r})]})},M=new Map,ae={set(t,s,a){M.has(t)||M.set(t,new Map);const n=M.get(t);if(!n.has(s)&&n.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(n.keys())[0]}.`);return}n.set(s,a)},get(t,s){return M.has(t)&&M.get(t).get(s)||null},remove(t,s){if(!M.has(t))return;const a=M.get(t);a.delete(s),a.size===0&&M.delete(t)}},lt=1e3,ce="transitionend",Ee=t=>(t&&window.CSS&&window.CSS.escape&&(t=t.replace(/#([^\s"#']+)/g,(s,a)=>`#${CSS.escape(a)}`)),t),it=t=>t==null?`${t}`:Object.prototype.toString.call(t).match(/\s([a-z]+)/i)[1].toLowerCase(),ct=t=>{if(!t)return 0;let{transitionDuration:s,transitionDelay:a}=window.getComputedStyle(t);const n=Number.parseFloat(s),l=Number.parseFloat(a);return!n&&!l?0:(s=s.split(",")[0],a=a.split(",")[0],(Number.parseFloat(s)+Number.parseFloat(a))*lt)},ot=t=>{t.dispatchEvent(new Event(ce))},Y=t=>!t||typeof t!="object"?!1:(typeof t.jquery<"u"&&(t=t[0]),typeof t.nodeType<"u"),ge=t=>Y(t)?t.jquery?t[0]:t:typeof t=="string"&&t.length>0?document.querySelector(Ee(t)):null,dt=t=>{if(!Y(t)||t.getClientRects().length===0)return!1;const s=getComputedStyle(t).getPropertyValue("visibility")==="visible",a=t.closest("details:not([open])");if(!a)return s;if(a!==t){const n=t.closest("summary");if(n&&n.parentNode!==a||n===null)return!1}return s},we=t=>!t||t.nodeType!==Node.ELEMENT_NODE||t.classList.contains("disabled")?!0:typeof t.disabled<"u"?t.disabled:t.hasAttribute("disabled")&&t.getAttribute("disabled")!=="false",ut=t=>{t.offsetHeight},ke=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,ne=[],ht=t=>{document.readyState==="loading"?(ne.length||document.addEventListener("DOMContentLoaded",()=>{for(const s of ne)s()}),ne.push(t)):t()},mt=t=>{ht(()=>{const s=ke();if(s){const a=t.NAME,n=s.fn[a];s.fn[a]=t.jQueryInterface,s.fn[a].Constructor=t,s.fn[a].noConflict=()=>(s.fn[a]=n,t.jQueryInterface)}})},Ne=(t,s=[],a=t)=>typeof t=="function"?t(...s):a,pt=(t,s,a=!0)=>{if(!a){Ne(t);return}const l=ct(s)+5;let r=!1;const i=({target:d})=>{d===s&&(r=!0,s.removeEventListener(ce,i),Ne(t))};s.addEventListener(ce,i),setTimeout(()=>{r||ot(s)},l)},ft=/[^.]*(?=\..*)\.|.*/,xt=/\..*/,bt=/::\d+$/,re={};let ve=1;const Ae={mouseenter:"mouseover",mouseleave:"mouseout"},jt=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function De(t,s){return s&&`${s}::${ve++}`||t.uidEvent||ve++}function Re(t){const s=De(t);return t.uidEvent=s,re[s]=re[s]||{},re[s]}function gt(t,s){return function a(n){return de(n,{delegateTarget:t}),a.oneOff&&S.off(t,n.type,s),s.apply(t,[n])}}function Nt(t,s,a){return function n(l){const r=t.querySelectorAll(s);for(let{target:i}=l;i&&i!==this;i=i.parentNode)for(const d of r)if(d===i)return de(l,{delegateTarget:i}),n.oneOff&&S.off(t,l.type,s,a),a.apply(i,[l])}}function Le(t,s,a=null){return Object.values(t).find(n=>n.callable===s&&n.delegationSelector===a)}function Oe(t,s,a){const n=typeof s=="string",l=n?a:s||a;let r=Te(t);return jt.has(r)||(r=t),[n,l,r]}function _e(t,s,a,n,l){if(typeof s!="string"||!t)return;let[r,i,d]=Oe(s,a,n);s in Ae&&(i=(b=>function(N){if(!N.relatedTarget||N.relatedTarget!==N.delegateTarget&&!N.delegateTarget.contains(N.relatedTarget))return b.call(this,N)})(i));const o=Re(t),u=o[d]||(o[d]={}),x=Le(u,i,r?a:null);if(x){x.oneOff=x.oneOff&&l;return}const m=De(i,s.replace(ft,"")),p=r?Nt(t,a,i):gt(t,i);p.delegationSelector=r?a:null,p.callable=i,p.oneOff=l,p.uidEvent=m,u[m]=p,t.addEventListener(d,p,r)}function oe(t,s,a,n,l){const r=Le(s[a],n,l);r&&(t.removeEventListener(a,r,!!l),delete s[a][r.uidEvent])}function vt(t,s,a,n){const l=s[a]||{};for(const[r,i]of Object.entries(l))r.includes(n)&&oe(t,s,a,i.callable,i.delegationSelector)}function Te(t){return t=t.replace(xt,""),Ae[t]||t}const S={on(t,s,a,n){_e(t,s,a,n,!1)},one(t,s,a,n){_e(t,s,a,n,!0)},off(t,s,a,n){if(typeof s!="string"||!t)return;const[l,r,i]=Oe(s,a,n),d=i!==s,o=Re(t),u=o[i]||{},x=s.startsWith(".");if(typeof r<"u"){if(!Object.keys(u).length)return;oe(t,o,i,r,l?a:null);return}if(x)for(const m of Object.keys(o))vt(t,o,m,s.slice(1));for(const[m,p]of Object.entries(u)){const g=m.replace(bt,"");(!d||s.includes(g))&&oe(t,o,i,p.callable,p.delegationSelector)}},trigger(t,s,a){if(typeof s!="string"||!t)return null;const n=ke(),l=Te(s),r=s!==l;let i=null,d=!0,o=!0,u=!1;r&&n&&(i=n.Event(s,a),n(t).trigger(i),d=!i.isPropagationStopped(),o=!i.isImmediatePropagationStopped(),u=i.isDefaultPrevented());const x=de(new Event(s,{bubbles:d,cancelable:!0}),a);return u&&x.preventDefault(),o&&t.dispatchEvent(x),x.defaultPrevented&&i&&i.preventDefault(),x}};function de(t,s={}){for(const[a,n]of Object.entries(s))try{t[a]=n}catch{Object.defineProperty(t,a,{configurable:!0,get(){return n}})}return t}function ye(t){if(t==="true")return!0;if(t==="false")return!1;if(t===Number(t).toString())return Number(t);if(t===""||t==="null")return null;if(typeof t!="string")return t;try{return JSON.parse(decodeURIComponent(t))}catch{return t}}function le(t){return t.replace(/[A-Z]/g,s=>`-${s.toLowerCase()}`)}const Ce={setDataAttribute(t,s,a){t.setAttribute(`data-bs-${le(s)}`,a)},removeDataAttribute(t,s){t.removeAttribute(`data-bs-${le(s)}`)},getDataAttributes(t){if(!t)return{};const s={},a=Object.keys(t.dataset).filter(n=>n.startsWith("bs")&&!n.startsWith("bsConfig"));for(const n of a){let l=n.replace(/^bs/,"");l=l.charAt(0).toLowerCase()+l.slice(1,l.length),s[l]=ye(t.dataset[n])}return s},getDataAttribute(t,s){return ye(t.getAttribute(`data-bs-${le(s)}`))}};class _t{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(s){return s=this._mergeConfigObj(s),s=this._configAfterMerge(s),this._typeCheckConfig(s),s}_configAfterMerge(s){return s}_mergeConfigObj(s,a){const n=Y(a)?Ce.getDataAttribute(a,"config"):{};return{...this.constructor.Default,...typeof n=="object"?n:{},...Y(a)?Ce.getDataAttributes(a):{},...typeof s=="object"?s:{}}}_typeCheckConfig(s,a=this.constructor.DefaultType){for(const[n,l]of Object.entries(a)){const r=s[n],i=Y(r)?"element":it(r);if(!new RegExp(l).test(i))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${n}" provided type "${i}" but expected type "${l}".`)}}}const yt="5.3.3";class Ct extends _t{constructor(s,a){super(),s=ge(s),s&&(this._element=s,this._config=this._getConfig(a),ae.set(this._element,this.constructor.DATA_KEY,this))}dispose(){ae.remove(this._element,this.constructor.DATA_KEY),S.off(this._element,this.constructor.EVENT_KEY);for(const s of Object.getOwnPropertyNames(this))this[s]=null}_queueCallback(s,a,n=!0){pt(s,a,n)}_getConfig(s){return s=this._mergeConfigObj(s,this._element),s=this._configAfterMerge(s),this._typeCheckConfig(s),s}static getInstance(s){return ae.get(ge(s),this.DATA_KEY)}static getOrCreateInstance(s,a={}){return this.getInstance(s)||new this(s,typeof a=="object"?a:null)}static get VERSION(){return yt}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(s){return`${s}${this.EVENT_KEY}`}}const ie=t=>{let s=t.getAttribute("data-bs-target");if(!s||s==="#"){let a=t.getAttribute("href");if(!a||!a.includes("#")&&!a.startsWith("."))return null;a.includes("#")&&!a.startsWith("#")&&(a=`#${a.split("#")[1]}`),s=a&&a!=="#"?a.trim():null}return s?s.split(",").map(a=>Ee(a)).join(","):null},ee={find(t,s=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(s,t))},findOne(t,s=document.documentElement){return Element.prototype.querySelector.call(s,t)},children(t,s){return[].concat(...t.children).filter(a=>a.matches(s))},parents(t,s){const a=[];let n=t.parentNode.closest(s);for(;n;)a.push(n),n=n.parentNode.closest(s);return a},prev(t,s){let a=t.previousElementSibling;for(;a;){if(a.matches(s))return[a];a=a.previousElementSibling}return[]},next(t,s){let a=t.nextElementSibling;for(;a;){if(a.matches(s))return[a];a=a.nextElementSibling}return[]},focusableChildren(t){const s=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(a=>`${a}:not([tabindex^="-"])`).join(",");return this.find(s,t).filter(a=>!we(a)&&dt(a))},getSelectorFromElement(t){const s=ie(t);return s&&ee.findOne(s)?s:null},getElementFromSelector(t){const s=ie(t);return s?ee.findOne(s):null},getMultipleElementsFromSelector(t){const s=ie(t);return s?ee.find(s):[]}},St=(t,s="hide")=>{const a=`click.dismiss${t.EVENT_KEY}`,n=t.NAME;S.on(document,a,`[data-bs-dismiss="${n}"]`,function(l){if(["A","AREA"].includes(this.tagName)&&l.preventDefault(),we(this))return;const r=ee.getElementFromSelector(this)||this.closest(`.${n}`);t.getOrCreateInstance(r)[s]()})},Et="toast",wt="bs.toast",q=`.${wt}`,kt=`mouseover${q}`,At=`mouseout${q}`,Dt=`focusin${q}`,Rt=`focusout${q}`,Lt=`hide${q}`,Ot=`hidden${q}`,Tt=`show${q}`,Ft=`shown${q}`,Mt="fade",Se="hide",Z="show",X="showing",It={animation:"boolean",autohide:"boolean",delay:"number"},qt={animation:!0,autohide:!0,delay:5e3};class K extends Ct{constructor(s,a){super(s,a),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return qt}static get DefaultType(){return It}static get NAME(){return Et}show(){if(S.trigger(this._element,Tt).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(Mt);const a=()=>{this._element.classList.remove(X),S.trigger(this._element,Ft),this._maybeScheduleHide()};this._element.classList.remove(Se),ut(this._element),this._element.classList.add(Z,X),this._queueCallback(a,this._element,this._config.animation)}hide(){if(!this.isShown()||S.trigger(this._element,Lt).defaultPrevented)return;const a=()=>{this._element.classList.add(Se),this._element.classList.remove(X,Z),S.trigger(this._element,Ot)};this._element.classList.add(X),this._queueCallback(a,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Z),super.dispose()}isShown(){return this._element.classList.contains(Z)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(s,a){switch(s.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=a;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=a;break}}if(a){this._clearTimeout();return}const n=s.relatedTarget;this._element===n||this._element.contains(n)||this._maybeScheduleHide()}_setListeners(){S.on(this._element,kt,s=>this._onInteraction(s,!0)),S.on(this._element,At,s=>this._onInteraction(s,!1)),S.on(this._element,Dt,s=>this._onInteraction(s,!0)),S.on(this._element,Rt,s=>this._onInteraction(s,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(s){return this.each(function(){const a=K.getOrCreateInstance(this,s);if(typeof s=="string"){if(typeof a[s]>"u")throw new TypeError(`No method named "${s}"`);a[s](this)}})}}St(K);mt(K);const ue=({data:t})=>{var s,a;return e.jsx("div",{className:"table-responsive",id:"rapport-table-container-ac",children:e.jsxs("table",{className:"table table-bordered  table-bordered ",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"bg-light sticky-col",children:"Clients/Articles"}),(s=t.articles)==null?void 0:s.map((n,l)=>e.jsx("th",{className:"text-center bg-light",children:n},l))]})}),e.jsxs("tbody",{children:[(a=t.clients)==null?void 0:a.map((n,l)=>{var r;return e.jsxs("tr",{children:[e.jsx("th",{className:"bg-light sticky-col",children:n}),(r=t.articles)==null?void 0:r.map((i,d)=>{var o;return e.jsx("td",{className:"text-center",children:((o=t.data[n])==null?void 0:o[i])&&e.jsx("div",{className:"cell-content",children:e.jsx("div",{className:"quantity",children:t.data[n][i].quantite>0?t.data[n][i].quantite:""})})},d)})]},l)}),t.clients.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:200,className:"text-center",children:"Aucune donnée trouvée"})})]})]})})},$t=({data:t,isLoading:s,onPrint:a,onRefresh:n,onBack:l})=>{const r=c.useMemo(()=>t,[t]);return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header px-0 d-flex align-items-center",children:[e.jsxs("button",{className:"btn btn-sm btn-outline-secondary me-2",onClick:l,children:[e.jsx("i",{className:"fas fa-chevron-left me-1"})," Retour"]}),e.jsx("h5",{className:"mb-0",children:"Rapport de vente par article et client"})]}),e.jsx("div",{className:"card-body",children:s?e.jsx("div",{className:"text-center my-5",children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):e.jsx(ue,{data:r})})]})},Pt=V.memo($t),Vt=({data:t,isLoading:s,onPrint:a,onRefresh:n,onBack:l})=>e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header px-0 d-flex align-items-center",children:[e.jsxs("button",{className:"btn btn-sm btn-outline-secondary me-2",onClick:l,children:[e.jsx("i",{className:"fas fa-chevron-left me-1"})," Retour"]}),e.jsx("h5",{className:"mb-0",children:"Rapport Stock"})]}),e.jsx("div",{className:"card-body",children:s?e.jsx("div",{className:"text-center my-5",children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):e.jsx("div",{className:"table-responsive",id:"rapport-table-container-as",children:e.jsxs("table",{className:"table table-striped table-bordered table-hover",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"bg-light",children:"Reference"}),e.jsx("th",{className:"bg-light",children:"Designation"}),e.jsx("th",{className:"bg-light",children:"Stock"})]})}),e.jsx("tbody",{children:t.map((r,i)=>e.jsxs("tr",{children:[e.jsx("td",{children:r.reference}),e.jsx("td",{children:r.designation}),e.jsx("td",{children:r.stock})]},i))})]})})})]}),Ht=V.memo(Vt),zt=({data:t,isLoading:s,onPrint:a,onRefresh:n,onBack:l})=>{const r=c.useMemo(()=>t.data,[t]);return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header px-0 d-flex align-items-center",children:[e.jsxs("button",{className:"btn btn-sm btn-outline-secondary me-2",onClick:l,children:[e.jsx("i",{className:"fas fa-chevron-left me-1"})," Retour"]}),e.jsx("h5",{className:"mb-0",children:"Rapport Articles-Fournisseurs"})]}),e.jsx("div",{className:"card-body",children:s?e.jsx("div",{className:"text-center my-5",children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):e.jsx(ue,{data:r})})]})},Kt=V.memo(zt),Fe=({data:t,formatDate:s,formatCurrency:a})=>e.jsx("div",{className:"table-responsive",id:"rapport-table-container-cr",children:e.jsxs("table",{className:"table  table-bordered ",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"bg-light",children:"Référence"}),e.jsx("th",{className:"bg-light",children:"Client"}),e.jsx("th",{className:"bg-light",children:"Méthode de Paiement"}),e.jsx("th",{className:"bg-light",children:"Date de Paiement"}),e.jsx("th",{className:"bg-light",children:"N° Chèque/LCN"}),e.jsx("th",{className:"bg-light",children:"Date de Vente"}),e.jsx("th",{className:"bg-light",children:"Contrôlé"}),e.jsx("th",{className:"bg-light",children:"Montant Total"}),e.jsx("th",{className:"bg-light",children:"Montant Créance"})]})}),e.jsx("tbody",{children:t.length>0?t.map((n,l)=>{let r="";return n.statut_paiement==="non_paye"?r="bg-danger bg-opacity-25":n.statut_paiement==="partiellement_paye"?r="bg-primary bg-opacity-25":n.statut_paiement==="paye"&&(r="bg-success bg-opacity-25"),e.jsxs("tr",{className:r,children:[e.jsx("td",{children:n.reference||"-"}),e.jsx("td",{children:n.client_name||"-"}),e.jsx("td",{children:n.last_payment_method||"-"}),e.jsx("td",{children:s(n.last_payment_date)}),e.jsx("td",{children:n.cheque_lcn_reference||"-"}),e.jsx("td",{children:s(n.sale_date)}),e.jsx("td",{children:n.is_controled?e.jsx("span",{className:"badge bg-success",children:"Oui"}):e.jsx("span",{className:"badge bg-danger",children:"Non"})}),e.jsx("td",{className:"text-end",children:a(n.total_ttc)}),e.jsx("td",{className:"text-end",children:a(n.creance_amount)})]},l)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"9",className:"text-center",children:"Aucune créance trouvée"})})}),t.length>0&&e.jsx("tfoot",{children:e.jsxs("tr",{className:"bg-light",children:[e.jsx("th",{colSpan:"8",className:"text-end",children:"Total des Créances:"}),e.jsx("th",{className:"text-end",children:a(t.reduce((n,l)=>n+parseFloat(l.creance_amount||0),0))})]})}),t.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:200,className:"text-center",children:"Aucune donnée trouvée"})})]})}),Wt=({data:t,isLoading:s,onPrint:a,onRefresh:n,onBack:l})=>{const r=c.useMemo(()=>t,[t]),i=o=>o||"-",d=o=>o==null?"-":new Intl.NumberFormat("fr-FR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(o);return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header px-0 d-flex align-items-center",children:[e.jsxs("button",{className:"btn btn-sm btn-outline-secondary me-2",onClick:l,children:[e.jsx("i",{className:"fas fa-chevron-left me-1"})," Retour"]}),e.jsx("h5",{className:"mb-0",children:"Rapport des Paiements et Créances"})]}),e.jsx("div",{className:"card-body",children:s?e.jsx("div",{className:"text-center my-5",children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):e.jsx(Fe,{data:r,formatDate:i,formatCurrency:d})})]})},Bt=V.memo(Wt),Me=({data:t,formatCurrency:s})=>e.jsx("div",{className:"table-responsive",id:"rapport-table-container-tr",children:e.jsxs("table",{className:"table table-striped table-bordered table-hover",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"bg-light",children:"Description"}),e.jsx("th",{className:"bg-light text-end",children:"Montant"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Total de Vente"})}),e.jsx("td",{className:"text-end",children:s(t.total_vente)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Total Espèce"})}),e.jsx("td",{className:"text-end",children:s(t.total_espece)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Total Chèque"})}),e.jsx("td",{className:"text-end",children:s(t.total_cheque)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Total LCN"})}),e.jsx("td",{className:"text-end",children:s(t.total_lcn)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Total Dépenses"})}),e.jsx("td",{className:"text-end",children:s(t.total_depenses)})]}),e.jsxs("tr",{className:"table-info",children:[e.jsx("td",{children:e.jsx("strong",{children:"Reste en Caisse"})}),e.jsx("td",{className:"text-end",children:e.jsx("strong",{children:s(t.reste_en_caisse)})})]})]})]})}),Yt=({data:t,isLoading:s,onPrint:a,onRefresh:n,onBack:l})=>{const r=c.useMemo(()=>t,[t]),i=d=>d==null?"-":new Intl.NumberFormat("fr-FR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(d);return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header px-0 d-flex align-items-center",children:[e.jsxs("button",{className:"btn btn-sm btn-outline-secondary me-2",onClick:l,children:[e.jsx("i",{style:{fontFamily:"Font Awesome 5 Free !important",fontWeight:900,marginRight:"0.25rem"},className:"fa-chevron-left"})," Retour"]}),e.jsx("h5",{className:"mb-0",children:"Rapport de Trésorerie"})]}),e.jsx("div",{className:"card-body",children:s?e.jsx("div",{className:"text-center my-5",children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):e.jsx(Me,{data:r,formatCurrency:i})})]})},Ut=V.memo(Yt),Qt=({data:t})=>{var s,a;return e.jsx("div",{className:"table-responsive",id:"rapport-table-container-af",children:e.jsxs("table",{className:"table table-striped table-bordered table-hover",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"bg-light sticky-col",children:"Fournisseurs/Articles"}),(s=t.articles)==null?void 0:s.map((n,l)=>e.jsx("th",{className:"text-center bg-light",children:n},l))]})}),e.jsxs("tbody",{children:[(a=t.fournisseurs)==null?void 0:a.map((n,l)=>{var r;return e.jsxs("tr",{children:[e.jsx("th",{className:"bg-light sticky-col",children:n}),(r=t.articles)==null?void 0:r.map((i,d)=>{var o;return e.jsx("td",{className:"text-center",children:((o=t.data[n])==null?void 0:o[i])&&e.jsx("div",{className:"cell-content",children:e.jsx("div",{className:"quantity",children:t.data[n][i].quantite>0?t.data[n][i].quantite:""})})},d)})]},l)}),t.fournisseurs.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:200,className:"text-center",children:"Aucune donnée trouvée"})})]})]})})},Jt=({onBack:t,onPrint:s})=>{const[a,n]=c.useState(!0),[l,r]=c.useState({articlesClients:{clients:[],articles:[],data:{}},articlesFournisseurs:{fournisseurs:[],articles:[],data:{}},creance:[],tresorie:{}});c.useEffect(()=>{i()},[]);const i=async()=>{n(!0);try{const[u,x,m,p]=await Promise.all([I.post("articles-clients-rapport",{session_id:__session_id}),I.post("articles-fournisseurs-rapport",{session_id:__session_id}),I.post("creance-rapport",{session_id:__session_id}),I.post("tresorie-rapport",{session_id:__session_id})]);r({articlesClients:u.data,articlesFournisseurs:x.data,creance:m.data,tresorie:p.data})}catch(u){console.error("Error fetching rapport data:",u)}finally{n(!1)}},d=u=>u||"-",o=u=>u==null?"-":new Intl.NumberFormat("fr-FR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(u);return e.jsxs("div",{className:"card ",children:[e.jsxs("div",{className:"card-header px-0 d-flex align-items-center",children:[e.jsxs("button",{className:"btn btn-sm btn-outline-secondary me-2",onClick:t,children:[e.jsx("i",{style:{fontFamily:"Font Awesome 5 Free !important",fontWeight:900,marginRight:"0.25rem"},className:"fa-chevron-left"})," Retour"]}),e.jsx("h5",{className:"mb-0",children:"Rapport Journalier"})]}),e.jsx("div",{className:"card-body",children:a?e.jsx("div",{className:"text-center my-5",children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})}):e.jsxs("div",{className:"row",id:"journlaier-tables",children:[__rapport_ac_enabled==1&&e.jsxs("div",{className:"col-12 mb-4",children:[e.jsx("h4",{children:"Rapport de vente par article et client"}),e.jsx(ue,{data:l.articlesClients})]}),__rapport_af_enabled==1&&e.jsxs("div",{className:"col-12 mb-4",children:[e.jsx("h4",{children:"Rapport Articles-Fournisseurs"}),e.jsx(Qt,{data:l.articlesFournisseurs})]}),__rapport_cr_enabled==1&&e.jsxs("div",{className:"col-12 mb-4",children:[e.jsx("h4",{children:"Rapport des Paiements et Créances"}),e.jsx(Fe,{data:l.creance,formatDate:d,formatCurrency:o})]}),__rapport_tr_enabled==1&&e.jsxs("div",{className:"col-12 mb-4",children:[e.jsx("h4",{children:"Rapport de Trésorerie"}),e.jsx(Me,{data:l.tresorie,formatCurrency:o})]})]})})]})},Gt=V.memo(Jt),Zt=()=>{const[t,s]=c.useState(null),[a,n]=c.useState({ac:{clients:[],articles:[],data:{},isLoading:!1},as:{data:[],isLoading:!1},af:{fournisseurs:[],articles:[],data:{},isLoading:!1},cr:{data:[],isLoading:!1},tr:{data:{},isLoading:!1}}),l=c.useMemo(()=>a.ac,[a.ac]),r=c.useMemo(()=>a.as.data,[a.as.data]),i=c.useMemo(()=>a.af,[a.af]),d=c.useMemo(()=>a.cr.data,[a.cr.data]),o=c.useMemo(()=>a.tr.data,[a.tr.data]),u=c.useMemo(()=>a.ac.isLoading,[a.ac.isLoading]),x=c.useMemo(()=>a.as.isLoading,[a.as.isLoading]),m=c.useMemo(()=>a.af.isLoading,[a.af.isLoading]),p=c.useMemo(()=>a.cr.isLoading,[a.cr.isLoading]),g=c.useMemo(()=>a.tr.isLoading,[a.tr.isLoading]),b=c.useCallback(h=>{let _,C;h==="ac"?(_="articles-clients-rapport",C=u):h==="af"?(_="articles-fournisseurs-rapport",C=m):h==="cr"?(_="creance-rapport",C=p):h==="tr"?(_="tresorie-rapport",C=g):(_="articles-stock-rapport",C=x),!C&&(n(j=>({...j,[h]:{...j[h],isLoading:!0}})),I.post(_,{session_id:__session_id}).then(j=>{n(P=>({...P,[h]:{...h==="ac"?j.data:{data:j.data},isLoading:!1}}))}).catch(j=>{var P,Q;n(H=>({...H,[h]:{...H[h],isLoading:!1}})),K.show(((Q=(P=j.response)==null?void 0:P.data)==null?void 0:Q.message)||"Error loading data")}))},[u,x,m,p]),N=c.useCallback(()=>b("ac"),[b]),E=c.useCallback(()=>b("as"),[b]),k=c.useCallback(()=>b("af"),[b]),A=c.useCallback(()=>b("cr"),[b]),R=c.useCallback(()=>b("tr"),[b]),v=c.useCallback(()=>b("jr"),[b]),f=c.useCallback((h,_)=>{const C=document.getElementById(h).innerHTML,j=window.open("","_blank");if(!j){K.show("Please allow pop-ups for printing");return}j.document.write(`
            <html>
                <head>
                    <title>${_}</title>
                    <style>
                        @page { size: A4; margin: 1cm; }
                        @media print {
                            body { margin: 0; padding: 0; font-size: 12px; }
                            .table { width: 100%; border-collapse: collapse; font-size: 10px; }
                            .table th, .table td { border: 1px solid #dee2e6; padding: 4px; text-align: center; }
                            .cell-content { page-break-inside: avoid; }
                            .print-header { text-align: center; margin-bottom: 20px; padding: 10px; }
                            .print-header h1 { font-size: 16px; margin: 0; }
                            .print-header .print-date { font-size: 12px; color: #666; }
                            .page-break { page-break-after: always; }
                            .no-print { display: none !important; }
                        }
                    </style>
                </head>
                <body>
                    <div class="print-header">
                        <h1>${_}</h1>
                        <div class="print-date">
                            Date d'impression: ${new Date().toLocaleTimeString("fr-FR")}
                        </div>
                    </div>
                    ${C}
                </body>
            </html>
        `),j.document.close(),j.focus(),j.onload=function(){j.print(),j.close()}},[]),L=c.useCallback(()=>{f("rapport-table-container-ac","Rapport de vente par article et client")},[f]),D=c.useCallback(()=>{f("rapport-table-container-as","Rapport Articles Stock")},[f]),w=c.useCallback(()=>{f("rapport-table-container-af","Rapport Articles-Fournisseurs")},[f]),U=c.useCallback(()=>{f("rapport-table-container-cr","Rapport des Créances")},[f]),T=c.useCallback(()=>{f("rapport-table-container-tr","Rapport de Trésorerie")},[f]),F=c.useCallback(h=>{s(h),h==="ac"?N():h==="as"?E():h==="af"?k():h==="cr"?A():h==="tr"?R():h==="jr"&&(E(),k(),A(),R())},[N,E,k,A,R]);return c.useMemo(()=>h=>new Intl.NumberFormat("fr-FR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(h),[]),e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-soft-primary mx-1","data-bs-target":"#rapports-modal","data-bs-toggle":"modal",children:e.jsx("i",{className:"fa fa-file-alt",children:" Rapports"})}),e.jsx("div",{className:"modal fade",id:"rapports-modal",tabIndex:"-1","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog modal-fullscreen",children:e.jsxs("div",{className:"modal-content bg-body",children:[e.jsxs("div",{className:"modal-header border-0 bg-body",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("button",{type:"button","data-bs-dismiss":"modal",className:"text-primary h3 me-3 mb-0 border-0 bg-transparent",children:e.jsx("i",{className:"fa fa-arrow-left"})}),e.jsx("h3",{className:"modal-title mb-0",children:"Rapports"})]}),e.jsxs("div",{className:"ms-auto",children:[t==="ac"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"btn btn-success me-2",onClick:L,disabled:u,children:[e.jsx("i",{className:"fas fa-print me-1"}),"Imprimer"]}),e.jsxs("button",{className:"btn btn-primary me-2",onClick:N,disabled:u,children:[e.jsx("i",{className:"fas fa-sync-alt me-1"}),"Actualiser"]})]}),t==="as"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"btn btn-success me-2",onClick:D,disabled:x,children:[e.jsx("i",{className:"fas fa-print me-1"}),"Imprimer"]}),e.jsxs("button",{className:"btn btn-primary me-2",onClick:E,disabled:x,children:[e.jsx("i",{className:"fas fa-sync-alt me-1"}),"Actualiser"]})]}),t==="af"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"btn btn-success me-2",onClick:w,disabled:m,children:[e.jsx("i",{className:"fas fa-print me-1"}),"Imprimer"]}),e.jsxs("button",{className:"btn btn-primary me-2",onClick:k,disabled:m,children:[e.jsx("i",{className:"fas fa-sync-alt me-1"}),"Actualiser"]})]}),t==="cr"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"btn btn-success me-2",onClick:U,disabled:p,children:[e.jsx("i",{className:"fas fa-print me-1"}),"Imprimer"]}),e.jsxs("button",{className:"btn btn-primary me-2",onClick:A,disabled:p,children:[e.jsx("i",{className:"fas fa-sync-alt me-1"}),"Actualiser"]})]}),t==="tr"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"btn btn-success me-2",onClick:T,disabled:g,children:[e.jsx("i",{className:"fas fa-print me-1"}),"Imprimer"]}),e.jsxs("button",{className:"btn btn-primary me-2",onClick:R,disabled:g,children:[e.jsx("i",{className:"fas fa-sync-alt me-1"}),"Actualiser"]})]}),t==="jr"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"btn btn-success me-2",onClick:()=>f("journlaier-tables","Rapport Journalier"),disabled:g,children:[e.jsx("i",{className:"fas fa-print me-1"}),"Imprimer"]}),e.jsxs("button",{className:"btn btn-primary me-2",onClick:v,children:[e.jsx("i",{className:"fas fa-sync-alt me-1"}),"Actualiser"]})]})]})]}),e.jsx("div",{className:"modal-body p-4",children:e.jsxs("div",{className:"container-fluid px-0",children:[!t&&e.jsxs("div",{className:"row",children:[__rapport_as_enabled==1&&e.jsx("div",{className:"col-md-6 mb-4",children:e.jsx("div",{className:"card card-rapport h-100",onClick:()=>F("as"),children:e.jsxs("div",{className:"card-body d-flex flex-column",children:[e.jsx("h5",{className:"card-title",children:"Rapport Stock"}),e.jsx("p",{className:"card-text flex-grow-1",children:"Affiche un rapport détaillé du stock disponible pour chaque article."})]})})}),e.jsxs("div",{className:"col-12",children:[e.jsx("h4",{children:"Rapports journalier"}),e.jsx("hr",{className:"border border-primary"})]}),__rapport_ac_enabled==1&&e.jsx("div",{className:"col-md-6 mb-4",children:e.jsx("div",{className:"card card-rapport h-100",onClick:()=>F("ac"),children:e.jsxs("div",{className:"card-body d-flex flex-column",children:[e.jsx("h5",{className:"card-title",children:"Rapport de vente par article et client"}),e.jsx("p",{className:"card-text flex-grow-1",children:"Affiche un rapport détaillé des articles achetés par chaque client."})]})})}),__rapport_af_enabled==1&&e.jsx("div",{className:"col-md-6 mb-4",children:e.jsx("div",{className:"card card-rapport h-100",onClick:()=>F("af"),children:e.jsxs("div",{className:"card-body d-flex flex-column",children:[e.jsx("h5",{className:"card-title",children:"Rapport Articles-Fournisseurs"}),e.jsx("p",{className:"card-text flex-grow-1",children:"Affiche un rapport détaillé des articles achetés auprès de chaque fournisseur."})]})})}),__rapport_cr_enabled==1&&e.jsx("div",{className:"col-md-6 mb-4",children:e.jsx("div",{className:"card card-rapport h-100",onClick:()=>F("cr"),children:e.jsxs("div",{className:"card-body d-flex flex-column",children:[e.jsx("h5",{className:"card-title",children:"Rapport des Paiements et Créances"}),e.jsx("p",{className:"card-text flex-grow-1",children:"Affiche un rapport détaillé des ventes non payées ou partiellement payées."})]})})}),__rapport_tr_enabled==1&&e.jsx("div",{className:"col-md-6 mb-4",children:e.jsx("div",{className:"card card-rapport h-100",onClick:()=>F("tr"),children:e.jsxs("div",{className:"card-body d-flex flex-column",children:[e.jsx("h5",{className:"card-title",children:"Rapport de Trésorerie"}),e.jsx("p",{className:"card-text flex-grow-1",children:"Affiche un résumé de la trésorerie de la session: ventes, espèces, chèques, LCN, dépenses et reste en caisse."})]})})}),(__rapport_tr_enabled||__rapport_cr_enabled||__rapport_af_enabled||__rapport_ac_enabled)==1&&e.jsx("div",{className:"col-md-6 mb-4",children:e.jsx("div",{className:"card card-rapport h-100",onClick:()=>F("jr"),children:e.jsxs("div",{className:"card-body d-flex flex-column",children:[e.jsx("h5",{className:"card-title",children:"Rapport Journalier"}),e.jsx("p",{className:"card-text flex-grow-1",children:"Afficher tous les rapports journalier."})]})})})]}),t==="ac"&&e.jsx(Pt,{data:l,isLoading:u,onPrint:L,onRefresh:N,onBack:()=>s(null)}),t==="as"&&e.jsx(Ht,{data:r,isLoading:x,onPrint:D,onRefresh:E,onBack:()=>s(null)}),t==="af"&&e.jsx(Kt,{data:i,isLoading:m,onPrint:w,onRefresh:k,onBack:()=>s(null)}),t==="cr"&&e.jsx(Bt,{data:d,isLoading:p,onPrint:U,onRefresh:A,onBack:()=>s(null)}),t==="tr"&&e.jsx(Ut,{data:o,isLoading:g,onPrint:T,onRefresh:R,onBack:()=>s(null)}),t==="jr"&&e.jsx(Gt,{onBack:()=>s(null),onPrint:f})]})})]})})}),e.jsx("style",{children:`
                    .card-rapport{
                        cursor: pointer;
                        transition: background-color 0.2s ease;
                    }
                    .card-rapport:hover{
                        background-color: #f8f9fa;
                    }
                    #rapports-modal .modal-fullscreen {
                        padding: 0 !important;
                    }

                    #rapports-modal .modal-fullscreen .modal-content {
                        min-height: 100vh;
                    }

                    #rapports-modal .sticky-col {
                        position: sticky;
                        left: 0;
                        z-index: 1;
                    }

                    #rapports-modal .cell-content {
                        padding: 5px;
                    }

                    #rapports-modal .cell-content .quantity {
                        font-weight: 500;
                        color: #495057;
                    }

                    #rapports-modal .cell-content .amount {
                        color: #6c757d;
                        font-size: 0.9em;
                    }

                    #rapport-table-container-ac .table th,
                    #rapport-table-container-as .table th,
                    #rapport-table-container-af .table th,
                    #rapport-table-container-cr .table th,
                    #rapport-table-container-tr .table th {
                        background-color: #f8f9fa;
                        white-space: nowrap;
                    }

                    #rapport-table-container-ac .table td,
                    #rapport-table-container-as .table td,
                    #rapport-table-container-af .table td,
                    #rapport-table-container-cr .table td,
                    #rapport-table-container-tr .table td {
                        vertical-align: middle;
                    }

                    #rapports-modal .modal-header {
                        background-color: #fff;
                        position: sticky;
                        top: 0;
                        z-index: 1050;
                    }
                `})]})},ns=V.memo(Zt);export{es as A,ss as C,as as H,ts as P,ns as R};
